(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+Jdq":function(e,t,n){"use strict";var r=n("QPTa");t.a={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if (__VERSION__ < 300)\n#extension GL_EXT_shader_texture_lod: enable\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n\n\n  float perceptualRoughness = u_MetallicRoughnessValues.y;\n  float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n  vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n  perceptualRoughness = mrSample.g * perceptualRoughness;\n  metallic = mrSample.b * metallic;\n#endif\n  perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n  metallic = clamp(metallic, 0.0, 1.0);\n\n  float alphaRoughness = perceptualRoughness * perceptualRoughness;\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n  diffuseColor *= 1.0 - metallic;\n  vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n  float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n  float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n  vec3 specularEnvironmentR0 = specularColor.rgb;\n  vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n  vec3 n = getNormal();\n  vec3 v = normalize(u_Camera - pbr_vPosition);\n\n  float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  vec3 reflection = -normalize(reflect(v, n));\n\n  PBRInfo pbrInputs = PBRInfo(\n    0.0,\n    NdotV,\n    0.0,\n    0.0,\n    0.0,\n    perceptualRoughness,\n    metallic,\n    specularEnvironmentR0,\n    specularEnvironmentR90,\n    alphaRoughness,\n    diffuseColor,\n    specularColor,\n    n,\n    v\n  );\n\n  vec3 color = vec3(0, 0, 0);\n\n#ifdef USE_LIGHTS\n  PBRInfo_setAmbientLight(pbrInputs);\n  color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n  SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n    if (i < lighting_uDirectionalLightCount) {\n      PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n      color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n    }\n  }\n  SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n    if (i < lighting_uPointLightCount) {\n      PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n      float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n      color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n    }\n  }\n#endif\n#ifdef USE_IBL\n  color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n  float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n  color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n  vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n  color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n  color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n  color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n  color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[r.a]}},J4mz:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n("HQhv"),n("JHok"),n("rzGZ"),n("Dq+y"),n("8npG"),n("Ggvi"),n("E5k/"),n("pJf4");var r=n("1OyB"),i=n("vuIU"),s=1048576,a=1024*s;function o(e){var t,n,r;return e<1?(t=1e3*e,n="μs",r=0):e<1e3?(t=e,n="ms",r=2):(t=e/1e3,n="s",r=2),"".concat(t.toFixed(r)).concat(n)}n("ofTv");var u=n("VwXc"),c=function(){function e(t,n){Object(r.a)(this,e),this.name=t,this.type=n,this.sampleSize=1,this.reset()}return Object(i.a)(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(u.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(u.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),f=function(){function e(t){var n=t.id,i=t.stats;Object(r.a)(this,e),this.id=n,this.stats={},this._initializeStats(i),Object.seal(this)}return Object(i.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,n=e.type;return this.stats[t]||(this.stats[t]=e instanceof c?e:new c(t,n)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}(),l={position:"fixed",zIndex:1e4,color:"#ccc",background:"#000",fontFamily:"Helvetica,Arial,sans-serif",padding:"8px",fontSize:"12px",lineSpacing:6},h={fontSize:"16px"},d={paddingLeft:"8px"},p={count:function(e){return"".concat(e.name,": ").concat(e.count)},averageTime:function(e){return"".concat(e.name,": ").concat(o(e.getAverageTime()))},totalTime:function(e){return"".concat(e.name,": ").concat(o(e.time))},fps:function(e){return"".concat(e.name,": ").concat(Math.round(e.getHz()),"fps")},memory:function(e){return"".concat(e.name,": ").concat(((t=e.count)<1024?(n=t,r=" bytes",i=0):t<s?(n=t/1024,r="kB",i=2):t<a?(n=t/s,r="MB",i=2):(n=t/a,r="GB",i=2),"".concat(n.toFixed(i)).concat(r)));var t,n,r,i}},m=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.stats=t,this.title=n.title,this._framesPerUpdate=Math.round(Math.max(n.framesPerUpdate||1,1)),this._formatters=p,this._resetOnUpdate={},this._counter=0,this._initializeFormatters(n),this._initializeUpdateConfigs(n),this._css=Object.assign({},l,n.css),this._headerCSS=Object.assign({},h,this._css.header),this._itemCSS=Object.assign({},d,this._css.item),delete this._css.header,delete this._css.item,this._container=null,this._header=null,this._items={},this._createDOM(n.container),this._createDOMHeader(),this._createDOMStats()}return Object(i.a)(e,[{key:"setStats",value:function(e){this.stats=e,this._createDOMStats(this._container),this._setHeaderContent(e.id),this.update()}},{key:"update",value:function(){var e=this.stats&&this.stats.stats;e&&0!==Object.keys(e).length&&this._counter++%this._framesPerUpdate==0&&this._update()}},{key:"_update",value:function(){var e=this;this.stats.forEach((function(t){e._createDOMItem(t.name),e._items[t.name].innerHTML=e._getLines(t).join("<BR>"),e._resetOnUpdate[t.name]&&t.reset()}))}},{key:"_initializeFormatters",value:function(e){if(e.formatters)for(var t in e.formatters){var n=e.formatters[t];"string"==typeof n&&(n=p[n]),this._formatters[t]=n}}},{key:"_initializeUpdateConfigs",value:function(e){if(e.resetOnUpdate)for(var t in e.resetOnUpdate)this._resetOnUpdate[t]=e.resetOnUpdate[t]}},{key:"_createDOM",value:function(e){if("undefined"!=typeof document&&document&&(this._container=e,!this._container)){for(var t in this._container=document.createElement("div"),this._css)this._container.style[t]=this._css[t];document.body.appendChild(this._container)}}},{key:"_createDOMHeader",value:function(){if(!this._header){for(var e in this._header=document.createElement("div"),this._headerCSS)this._header.style[e]=this._headerCSS[e];this._container.appendChild(this._header)}this._setHeaderContent()}},{key:"_setHeaderContent",value:function(e){this._header&&(this._header.innerText=e||this.title||this.stats&&this.stats.id||"")}},{key:"_createDOMStats",value:function(){var e=this;this.stats instanceof f&&this.stats.forEach((function(t){e._createDOMItem(t.name)}))}},{key:"_createDOMItem",value:function(e){if(this._container&&!this._items[e]){for(var t in this._items[e]=document.createElement("div"),this._itemCSS)this._items[e].style[t]=this._itemCSS[t];this._container.appendChild(this._items[e])}}},{key:"_getLines",value:function(e){return(this._formatters[e.name]||this._formatters[e.type]||p.count)(this.stats.get(e.name)).split("\n")}}]),e}()},NY3r:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));n("rzGZ"),n("Dq+y"),n("8npG"),n("Ggvi"),n("JHok"),n("pJf4"),n("MIFh"),n("AqHK"),n("E5k/");var r=n("1OyB"),i=n("vuIU"),s=n("c9N0"),a=n("iein"),o=n("sc/6"),u=n("T2Hy"),c=(n("m210"),n("4DPX"),n("sc67"),n("KQm4")),f=n("md7G"),l=n("foSv"),h=n("ReuC"),d=n("Ji7U"),p=n("UhMv"),m=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,t);var i=n=Array.isArray(n)?{children:n}:n,s=i.children,o=void 0===s?[]:s;return a.g.assert(o.every((function(e){return e instanceof p.a})),"every child must an instance of ScenegraphNode"),(e=Object(f.a)(this,Object(l.a)(t).call(this,n))).children=o,e}return Object(d.a)(t,e),Object(i.a)(t,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var s=i[r];Array.isArray(s)?this.add.apply(this,Object(c.a)(s)):this.children.push(s)}return this}},{key:"remove",value:function(e){var t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach((function(e){return e.delete()})),this.removeAll(),Object(h.a)(Object(l.a)(t.prototype),"delete",this).call(this)}},{key:"traverse",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.worldMatrix,i=void 0===r?new s.b:r,a=new s.b(i).multiplyRight(this.matrix),o=!0,u=!1,c=void 0;try{for(var f,l=this.children[Symbol.iterator]();!(o=(f=l.next()).done);o=!0){var h=f.value;h instanceof t?h.traverse(e,{worldMatrix:a}):e(h,{worldMatrix:a})}}catch(d){u=!0,c=d}finally{try{o||null==l.return||l.return()}finally{if(u)throw c}}}}]),t}(p.a),v=(n("zTTH"),n("YbXK"),n("cFtU"),n("5irr"),n("SIeT"),n("h3Sa"),n("AItV"),n("CtJk"),n("88iX"),n("CxzY")),g={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},b={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function _(e){if(!e._animation){var t=b[e.componentType],n=g[e.type],r=n*e.count,i=e.bufferView.data,s=new t(i.buffer,i.byteOffset+(e.byteOffset||0),r);if(1===n)e._animation=Array.from(s);else{for(var a=[],o=0;o<s.length;o+=n)a.push(Array.from(s.slice(o,o+n)));e._animation=a}}return e._animation}var y=new s.b;var x=new s.c;function A(e,t,n,r){var i=t.input,s=t.interpolation,o=t.output,u=e%i[i.length-1],c=i.findIndex((function(e){return e>=u})),f=Math.max(0,c-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:a.g.warn("Bad animation path ".concat(r))()}Object(v.a)(n[r].length===o[f].length);var l=i[f],h=i[c];switch(s){case"STEP":!function(e,t,n){for(var r=0;r<n.length;r++)e[t][r]=n[r]}(n,r,o[f]);break;case"LINEAR":if(h>l){var d=(u-l)/(h-l);!function(e,t,n,r,i){if("rotation"===t){x.slerp({start:n,target:r,ratio:i});for(var s=0;s<x.length;s++)e[t][s]=x[s]}else for(var a=0;a<n.length;a++)e[t][a]=i*r[a]+(1-i)*n[a]}(n,r,o[f],o[c],d)}break;case"CUBICSPLINE":if(h>l){var p=(u-l)/(h-l),m=h-l;!function(e,t,n){for(var r=n.p0,i=n.outTangent0,s=n.inTangent1,a=n.p1,o=n.tDiff,u=n.ratio,c=0;c<e[t].length;c++){var f=i[c]*o,l=s[c]*o;e[t][c]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*r[c]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*f+(-2*Math.pow(u,3)+3*Math.pow(u,2))*a[c]+(Math.pow(u,3)-Math.pow(u,2))*l}}(n,r,{p0:o[3*f+1],outTangent0:o[3*f+2],inTangent1:o[3*c+0],p1:o[3*c+1],tDiff:m,ratio:p})}break;default:a.g.warn("Interpolation ".concat(s," not supported"))()}}var S=function(){function e(t){Object(r.a)(this,e),this.startTime=0,this.playing=!0,this.speed=1,Object.assign(this,t)}return Object(i.a)(e,[{key:"animate",value:function(e){if(this.playing){var t=(e/1e3-this.startTime)*this.speed;this.channels.forEach((function(e){var n=e.sampler,r=e.target,i=e.path;A(t,n,r,i),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){var n=y.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)}))}}}]),e}(),O=function(){function e(t){Object(r.a)(this,e),this.animations=t.animations.map((function(e,n){var r=e.name||"Animation-".concat(n),i=e.samplers.map((function(e){var n=e.input,r=e.interpolation,i=void 0===r?"LINEAR":r,s=e.output;return{input:_(t.accessors[n]),interpolation:i,output:_(t.accessors[s])}})),s=e.channels.map((function(e){var n=e.sampler,r=e.target;return{sampler:i[n],target:t.nodes[r.node],path:r.path}}));return new S({name:r,channels:s})}))}return Object(i.a)(e,[{key:"animate",value:function(e){this.setTime(e)}},{key:"setTime",value:function(e){this.animations.forEach((function(t){return t.animate(e)}))}},{key:"getAnimations",value:function(){return this.animations}}]),e}(),T=(n("cxuS"),n("+Jdq")),R=n("ykdB"),E=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,t),(n=Object(f.a)(this,Object(l.a)(t).call(this,i))).onBeforeRender=null,n.AfterRender=null,e instanceof R.a?(n.model=e,n._setModelNodeProps(i)):n.model=new R.a(e,i),n.managedResources=i.managedResources||[],n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"setProps",value:function(e){return Object(h.a)(Object(l.a)(t.prototype),"setProps",this).call(this,e),this._setModelNodeProps(e),this}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((function(e){return e.delete()})),this.managedResources=[]}},{key:"draw",value:function(){var e;return(e=this.model).draw.apply(e,arguments)}},{key:"setUniforms",value:function(){var e;return(e=this.model).setUniforms.apply(e,arguments),this}},{key:"setAttributes",value:function(){var e;return(e=this.model).setAttributes.apply(e,arguments),this}},{key:"updateModuleSettings",value:function(){var e;return(e=this.model).updateModuleSettings.apply(e,arguments),this}},{key:"_setModelNodeProps",value:function(e){this.model.setProps(e)}}]),t}(p.a),w=n("rePB"),I=n("d3kR"),j=n("tMmZ"),C=n("f5Sf"),M=function(){function e(t,n){var i=n.attributes,s=n.material,a=n.pbrDebug,o=n.imageBasedLightingEnvironment,u=n.lights,c=n.useTangents;Object(r.a)(this,e),this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Object(I.b)(t,j.a.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),a&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(u,"USE_LIGHTS"),this.defineIfPresent(a,"PBR_DEBUG"),s&&this.parseMaterial(s)}return Object(i.a)(e,[{key:"defineIfPresent",value:function(e,t){e&&(this.defines[t]=1)}},{key:"parseTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},i=new C.a(this.gl,{id:e.name||e.id,parameters:r,pixelStore:Object(w.a)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1),data:e.texture.source.image});this.uniforms[t]=i,this.defineIfPresent(n,n),this.generatedTextures.push(i)}},{key:"parsePbrMetallicRoughness",value:function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var t=e.metallicFactor,n=void 0===t?1:t,r=e.roughnessFactor,i=void 0===r?1:r;this.uniforms.u_MetallicRoughnessValues=[n,i]}},{key:"parseMaterial",value:function(e){if(e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var t=e.normalTexture.scale,n=void 0===t?1:t;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var r=e.occlusionTexture.strength,i=void 0===r?1:r;this.uniforms.u_OcclusionStrength=i}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){var s=e.alphaCutoff,o=void 0===s?.5:s;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=o}else"BLEND"===e.alphaMode&&(a.g.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}]),e}();function N(e,t){return Object(a.f)(e)?"#version 300 es\n".concat(t):t}var L={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},P=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.gl=t,this.options=Object.assign({},k,n)}return Object(i.a)(e,[{key:"instantiate",value:function(e){var t=this;return this.gltf=e,(e.scenes||[]).map((function(e){return t.createScene(e)}))}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new O(this.gltf):null}},{key:"createScene",value:function(e){var t=this,n=(e.nodes||[]).map((function(e){return t.createNode(e)}));return new m({id:e.name||e.id,children:n})}},{key:"createNode",value:function(e){var t=this;if(!e._node){var n=(e.children||[]).map((function(e){return t.createNode(e)}));e.mesh&&n.push(this.createMesh(e.mesh));var r=new m({id:e.name||e.id,children:n});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){var i=(new s.b).fromQuaternion(e.rotation);r.matrix.multiplyRight(i)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}},{key:"createMesh",value:function(e){var t=this;if(!e._mesh){var n=(e.primitives||[]).map((function(n,r){return t.createPrimitive(n,r,e)})),r=new m({id:e.name||e.id,children:n});e._mesh=r}return e._mesh}},{key:"getVertexCount",value:function(e){a.g.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(e,t,n){return function(e,t){var n=t.id,r=t.drawMode,i=t.vertexCount,s=t.attributes,o=t.modelOptions,u=new M(e,t);a.g.info(4,"createGLTFModel defines: ",u.defines)();var f=[];f.push.apply(f,Object(c.a)(u.generatedTextures)),f.push.apply(f,Object(c.a)(Object.values(s).map((function(e){return e.buffer}))));var l=new E(e,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[T.a],defines:u.defines,parameters:u.parameters,vs:N(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:N(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:f},o));return l.setProps({attributes:s}),l.setUniforms(u.uniforms),l}(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}},{key:"createAttributes",value:function(e,t){var n=this,r={};return Object.keys(e).forEach((function(t){r[t]=n.createAccessor(e[t],n.createBuffer(e[t],n.gl.ARRAY_BUFFER))})),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),a.g.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}},{key:"createBuffer",value:function(e,t){e.bufferView||(e.bufferView={});var n=e.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new o.a(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}},{key:"createAccessor",value:function(e,t){return new u.a({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:L[e.type]})}},{key:"createSampler",value:function(e){return e}},{key:"needsPOT",value:function(){return!1}}]),e}();function B(e,t,n){var r=new P(e,n);return{scenes:r.instantiate(t),animator:r.createAnimator()}}},UhMv:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n("E5k/"),n("pJf4");var r=n("1OyB"),i=n("vuIU"),s=n("c9N0"),a=n("VdrS"),o=n("CxzY"),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,e);var n=t.id;this.id=n||Object(a.c)(this.constructor.name),this.display=!0,this.position=new s.e,this.rotation=new s.e,this.scale=new s.e(1,1,1),this.matrix=new s.b,this.userData={},this.props={},this._setScenegraphNodeProps(t)}return Object(i.a)(e,[{key:"delete",value:function(){}},{key:"setProps",value:function(e){return this._setScenegraphNodeProps(e),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"setPosition",value:function(e){return Object(o.a)(3===e.length,"setPosition requires vector argument"),this.position=e,this}},{key:"setRotation",value:function(e){return Object(o.a)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}},{key:"setScale",value:function(e){return Object(o.a)(3===e.length,"setScale requires vector argument"),this.scale=e,this}},{key:"setMatrix",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.matrix.copy(e):this.matrix=e}},{key:"setMatrixComponents",value:function(e){var t=e.position,n=e.rotation,r=e.scale,i=e.update,s=void 0===i||i;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),s&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.position,n=e.rotation,r=e.scale;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(e,t){Object(o.a)(e),t=t||this.matrix;var n=new s.b(e).multiplyRight(t),r=n.invert(),i=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"_setScenegraphNodeProps",value:function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}]),e}()},VwXc:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));n("1dPr");function r(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var n=e.hrtime();t=1e3*n[0]+n[1]/1e6}else t=Date.now();return t}}).call(this,n("8oxB"))},WraG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("lC2f");function i(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'+Object(r.a)(e)+'"')}}},lC2f:function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return i(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return i(e,0,t)}return""}function i(e,t,n){if(e.byteLength<=t+n)return"";for(var r=new DataView(e),i="",s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}n.d(t,"a",(function(){return r}))},ngZ5:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));n("CtJk");function r(e){return e+3&-4}function i(e,t,n){var r=n?new Uint8Array(e).subarray(t,t+n):new Uint8Array(e).subarray(t);return new Uint8Array(r).buffer}function s(e,t,n){var i;if(e instanceof ArrayBuffer)i=new Uint8Array(e);else{var s=e.byteOffset,a=e.byteLength;i=new Uint8Array(e.buffer,s,a)}return t.set(i,n),n+r(i.byteLength)}},"yx+g":function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"decode",(function(){return N})),n.d(r,"encode",(function(){return k}));var i={};n.r(i),n.d(i,"decode",(function(){return G})),n.d(i,"encode",(function(){return z}));var s={};n.r(s),n.d(s,"decode",(function(){return K})),n.d(s,"encode",(function(){return W}));var a={};n.r(a),n.d(a,"decode",(function(){return Z})),n.d(a,"encode",(function(){return Q}));var o=n("o0o1"),u=n.n(o),c=(n("E5k/"),n("wcNg"),n("6kNP"),n("8npG"),n("YBKJ"),n("9ZhD"),n("rzGZ"),n("Dq+y"),n("YbXK"),n("n0hJ"),n("gQyj")),f=n("WraG"),l=n("ngZ5");function h(e,t){if(!e)throw new Error(t||"assert failed: gltf")}n("TAD1");function d(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url "+e);return n.substr(0,n.lastIndexOf("/")+1)+e}n("CtJk");function p(e,t,n){var r=e.bufferViews[n];h(r);var i=t[r.buffer];h(i);var s=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,s,r.byteLength)}n("m210"),n("4DPX"),n("cFtU"),n("pJf4"),n("q8oJ"),n("Ggvi"),n("v9g0");var m=n("9upa");n("5irr"),n("SIeT"),n("h3Sa"),n("AItV"),n("88iX"),n("xJgp");var v=["SCALAR","VEC2","VEC3","VEC4"],g=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),b={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},y={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function x(e){return v[e-1]||v[0]}function A(e){var t=g.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function S(e,t){var n=y[e.componentType],r=b[e.type],i=_[e.componentType],s=e.count*r,a=e.count*r*i;return h(a>=0&&a<=t.byteLength),{ArrayType:n,length:s,byteLength:a}}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(t){if(t instanceof e)return t;t||(t={json:{version:2,buffers:[]},buffers:[]}),this.gltf=t,h(this.gltf.json)}var t,n,r,i=e.prototype;return i.getApplicationData=function(e){return this.json[e]},i.getExtraData=function(e){return(this.json.extras||{})[e]},i.getExtension=function(e){var t=this.getUsedExtensions().find((function(t){return t===e})),n=this.json.extensions||{};return t?n[e]||!0:null},i.getRequiredExtension=function(e){return this.getRequiredExtensions().find((function(t){return t===e}))?this.getExtension(e):null},i.getRequiredExtensions=function(){return this.json.extensionsRequired||[]},i.getUsedExtensions=function(){return this.json.extensionsUsed||[]},i.getObjectExtension=function(e,t){return(e.extensions||{})[t]},i.getScene=function(e){return this.getObject("scenes",e)},i.getNode=function(e){return this.getObject("nodes",e)},i.getSkin=function(e){return this.getObject("skins",e)},i.getMesh=function(e){return this.getObject("meshes",e)},i.getMaterial=function(e){return this.getObject("materials",e)},i.getAccessor=function(e){return this.getObject("accessors",e)},i.getCamera=function(e){return null},i.getTexture=function(e){return this.getObject("textures",e)},i.getSampler=function(e){return this.getObject("samplers",e)},i.getImage=function(e){return this.getObject("images",e)},i.getBufferView=function(e){return this.getObject("bufferViews",e)},i.getBuffer=function(e){return this.getObject("buffers",e)},i.getObject=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find "+e+"["+t+"]");return n},i.getTypedArrayForBufferView=function(e){var t=(e=this.getBufferView(e)).buffer,n=this.gltf.buffers[t];h(n);var r=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,e.byteLength)},i.getTypedArrayForAccessor=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=S(e,t),i=r.ArrayType,s=r.length;return new i(n,t.byteOffset+e.byteOffset,s)},i.getTypedArrayForImageData=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)},i.addApplicationData=function(e,t){return this.json[e]=t,this},i.addExtraData=function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this},i.addObjectExtension=function(e,t,n){return h(n),e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this},i.removeObjectExtension=function(e,t){return delete(e.extensions||{})[t],this},i.addExtension=function(e,t){return void 0===t&&(t={}),h(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t},i.addRequiredExtension=function(e,t){return void 0===t&&(t={}),h(t),this.addExtension(e,t),this.registerRequiredExtension(e),t},i.registerUsedExtension=function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(t){return t===e}))||this.json.extensionsUsed.push(e)},i.registerRequiredExtension=function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(t){return t===e}))||this.json.extensionsRequired.push(e)},i.removeExtension=function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]},i.setObjectExtension=function(e,t,n){(e.extensions||{})[t]=n},i.addMesh=function(e,t,n){void 0===n&&(n=4);var r={primitives:[{attributes:this._addAttributes(e),indices:t,mode:n}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1},i.addPointCloud=function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1},i.addImage=function(e,t){var n,r;t=t||(n=e,(r=Object(m.a)(n))?r.mimeType:null);var i={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1},i.addBufferView=function(e){var t=e.byteLength;h(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Object(l.c)(t),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1},i.addAccessor=function(e,t){var n={bufferView:e,type:x(t.size),componentType:t.componentType,count:t.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1},i.addBinaryBuffer=function(e,t){void 0===t&&(t={size:3});var n=this.addBufferView(e),r={size:t.size,componentType:A(e),count:Math.round(e.length/t.size)};return this.addAccessor(n,Object.assign(r,t))},i.createBinaryChunk=function(){if(!this.arrayBuffer){for(var e=this.byteLength,t=new ArrayBuffer(e),n=new Uint8Array(t),r=0,i=0;i<this.sourceBuffers.length;i++){var s=this.sourceBuffers[i];r=Object(l.a)(s,n,r)}this.json.buffers[0].byteLength=e,this.arrayBuffer=t,this.sourceBuffers=[]}},i._removeStringFromArray=function(e,t){for(var n=!0;n;){var r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}},t=e,(n=[{key:"json",get:function(){return this.gltf.json}}])&&O(t.prototype,n),r&&O(t,r),e}();function R(e){var t={};for(var n in e){var r=e[n];if("indices"!==n){var i=E(r);t[n]=i}}return t}function E(e,t){var n=function(e,t){var n=e,r=1,i=0;e&&e.value&&(n=e.value,r=e.size||1);n&&(ArrayBuffer.isView(n)||(n=function(e,t,n){void 0===n&&(n=!1);if(!e)return null;if(Array.isArray(e))return new t(e);if(n&&!(e instanceof t))return new t(e);return e}(n,Float32Array)),i=n.length/r);return{buffer:n,size:r,count:i}}(e),r=n.buffer,i=n.size;return{value:r,size:i,bufferView:null,byteOffset:0,count:n.count,type:x(i),componentType:A(r)}}var w=u.a.mark(H);function I(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function M(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){C(s,r,i,a,o,"next",e)}function o(e){C(s,r,i,a,o,"throw",e)}a(void 0)}))}}function N(e,t,n){return L.apply(this,arguments)}function L(){return(L=M(u.a.mark((function e(t,n,r){var i,s,a,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.gltf.decompressMeshes){e.next=2;break}return e.abrupt("return");case 2:for(i=new T(t),s=[],a=I(H(i));!(o=a()).done;)c=o.value,i.getObjectExtension(c,"KHR_draco_mesh_compression")&&s.push(P(c,i,n,r));return e.next=7,Promise.all(s);case 7:i.removeExtension("KHR_draco_mesh_compression");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){void 0===t&&(t={});for(var n,r=new T(e),i=I(r.json.meshes||[]);!(n=i()).done;){U(n.value,t),r.addRequiredExtension("KHR_draco_mesh_compression")}}function P(e,t,n,r){return B.apply(this,arguments)}function B(){return(B=M(u.a.mark((function e(t,n,r,i){var s,a,o,c,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.getObjectExtension(t,"KHR_draco_mesh_compression"),a=n.getTypedArrayForBufferView(s.bufferView),o=Object(l.b)(a.buffer,a.byteOffset),c=i.parse,e.next=6,c(o,[],r,i);case 6:f=e.sent,t.attributes=R(f.attributes),f.indices&&(t.indices=E(f.indices)),V(t);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,n,r,i){var s;if(void 0===n&&(n=4),!r.DracoWriter||!r.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var a=r.DracoWriter.encodeSync({attributes:e}),o=(0,i.parseSync)({attributes:e}),u=r._addFauxAttributes(o.attributes),c=r.addBufferView(a);return{primitives:[{attributes:u,mode:n,extensions:(s={},s.KHR_draco_mesh_compression={bufferView:c,attributes:u},s)}]}}function V(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function H(e){var t,n,r,i,s,a;return u.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=I(e.json.meshes||[]);case 1:if((n=t()).done){o.next=12;break}r=n.value,i=I(r.primitives);case 4:if((s=i()).done){o.next=10;break}return a=s.value,o.next=8,a;case 8:o.next=4;break;case 10:o.next=1;break;case 12:case"end":return o.stop()}}),w)}function D(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G(e,t){var n=new T(e),r=n.json,i=n.getExtension("KHR_lights_punctual");i&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual"));for(var s,a=D(r.nodes||[]);!(s=a()).done;){var o=s.value,u=n.getObjectExtension(o,"KHR_lights_punctual");u&&(o.light=u.light),n.removeObjectExtension(o,"KHR_lights_punctual")}}function z(e,t){var n=new T(e),r=n.json;if(r.lights){var i=n.addExtension("KHR_lights_punctual");h(!i.lights),i.lights=r.lights,delete r.lights}if(n.json.lights){for(var s,a=D(n.json.lights);!(s=a()).done;){var o=s.value,u=o.node;n.addObjectExtension(u,"KHR_lights_punctual",o)}delete n.json.lights}}function q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){var n=new T(e),r=n.json;n.removeExtension("KHR_materials_unlit");for(var i,s=q(r.materials||[]);!(i=s()).done;){var a=i.value;a.extensions&&a.extensions.KHR_materials_unlit&&(a.unlit=!0),n.removeObjectExtension(a,"KHR_materials_unlit")}}function W(e,t){var n=new T(e),r=n.json;if(n.materials)for(var i,s=q(r.materials);!(i=s()).done;){var a=i.value;a.unlit&&(delete a.unlit,n.addObjectExtension(a,"KHR_materials_unlit"),n.addExtension("KHR_materials_unlit"))}}function J(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Z(e,t){var n=new T(e),r=n.json,i=n.getExtension("KHR_techniques_webgl");if(i){for(var s,a=function(e,t){var n=e.programs,r=void 0===n?[]:n,i=e.shaders,s=void 0===i?[]:i,a=e.techniques,o=void 0===a?[]:a,u=new TextDecoder;return s.forEach((function(e){if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=u.decode(t.getTypedArrayForBufferView(e.bufferView))})),r.forEach((function(e){e.fragmentShader=s[e.fragmentShader],e.vertexShader=s[e.vertexShader]})),o.forEach((function(e){e.program=r[e.program]})),o}(i,n),o=J(r.materials||[]);!(s=o()).done;){var u=s.value,c=n.getObjectExtension(u,"KHR_techniques_webgl");c&&(u.technique=Object.assign({},c,a[c.technique]),u.technique.values=$(u.technique,n)),n.removeObjectExtension(u,"KHR_techniques_webgl")}n.removeExtension("KHR_techniques_webgl")}}function Q(e,t){}function $(e,t){var n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((function(t){e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)})),Object.keys(n).forEach((function(e){"object"==typeof n[e]&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))})),n}function ee(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function te(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){ee(s,r,i,a,o,"next",e)}function o(e){ee(s,r,i,a,o,"throw",e)}a(void 0)}))}}var ne={KHR_draco_mesh_compression:r,KHR_lights_punctual:i,KHR_materials_unlit:s,KHR_techniques_webgl:a};function re(e,t,n){return ie.apply(this,arguments)}function ie(){return(ie=te(u.a.mark((function e(t,n,r){var i,s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n={}),n.gltf=n.gltf||{},e.t0=u.a.keys(ne);case 3:if((e.t1=e.t0()).done){e.next=13;break}if(i=e.t1.value,s=n.gltf.excludeExtensions||{},i in s&&!s[i]){e.next=11;break}return a=ne[i],e.next=11,a.decode(t,n,r);case 11:e.next=3;break;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var se,ae=n("P+ME");function oe(e,t,n){void 0===t&&(t=0),void 0===n&&(n={});var r=new DataView(e),i=n.magic,s=void 0===i?1735152710:i,a=r.getUint32(t,!1);return a===s||1735152710===a}function ue(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r={});var i=new DataView(t);e.type=function(e,t){return void 0===t&&(t=0),""+String.fromCharCode(e.getUint8(t+0))+String.fromCharCode(e.getUint8(t+1))+String.fromCharCode(e.getUint8(t+2))+String.fromCharCode(e.getUint8(t+3))}(i,n+0),e.version=i.getUint32(n+4,!0);var s=i.getUint32(n+8,!0);return e.header={byteOffset:n,byteLength:s},Object(ae.a)(2===e.version,"Invalid GLB version "+e.version+". Only supports v2."),Object(ae.a)(e.header.byteLength>20),e.json={},e.binChunks=[],function(e,t,n,r){for(;n+8<=e.header.byteLength;){var i=t.getUint32(n+0,!0),s=t.getUint32(n+4,!0);switch(n+=8,s){case 1313821514:ce(e,t,n,i,r);break;case 5130562:fe(e,t,n,i,r);break;case 0:r.glb.strict||ce(e,t,n,i,r);break;case 1:r.glb.strict||fe(e,t,n,i,r)}n+=Object(l.c)(i)}}(e,i,n+12,r),n+e.header.byteLength}function ce(e,t,n,r,i){var s=new Uint8Array(t.buffer,n,r),a=new TextDecoder("utf8").decode(s);e.json=JSON.parse(a)}function fe(e,t,n,r,i){e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer})}var le={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},he={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},de={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},pe={magFilter:de.TEXTURE_MAG_FILTER,minFilter:de.TEXTURE_MIN_FILTER,wrapS:de.TEXTURE_WRAP_S,wrapT:de.TEXTURE_WRAP_T},me=((se={})[de.TEXTURE_MAG_FILTER]=de.LINEAR,se[de.TEXTURE_MIN_FILTER]=de.NEAREST_MIPMAP_LINEAR,se[de.TEXTURE_WRAP_S]=de.REPEAT,se[de.TEXTURE_WRAP_]=de.REPEAT,se);var ve=function(){function e(){}var t=e.prototype;return t.postProcess=function(e,t){void 0===t&&(t={});var n=e.json,r=e.buffers,i=void 0===r?[]:r,s=e.images,a=void 0===s?[]:s,o=e.baseUri,u=void 0===o?"":o;return h(n),this.baseUri=u,this.json=n,this.buffers=i,this.images=a,this._resolveTree(this.json,t),this.json},t._resolveTree=function(e,t){var n=this;void 0===t&&(t={}),e.bufferViews&&(e.bufferViews=e.bufferViews.map((function(e,t){return n._resolveBufferView(e,t)}))),e.images&&(e.images=e.images.map((function(e,t){return n._resolveImage(e,t)}))),e.samplers&&(e.samplers=e.samplers.map((function(e,t){return n._resolveSampler(e,t)}))),e.textures&&(e.textures=e.textures.map((function(e,t){return n._resolveTexture(e,t)}))),e.accessors&&(e.accessors=e.accessors.map((function(e,t){return n._resolveAccessor(e,t)}))),e.materials&&(e.materials=e.materials.map((function(e,t){return n._resolveMaterial(e,t)}))),e.meshes&&(e.meshes=e.meshes.map((function(e,t){return n._resolveMesh(e,t)}))),e.nodes&&(e.nodes=e.nodes.map((function(e,t){return n._resolveNode(e,t)}))),e.skins&&(e.skins=e.skins.map((function(e,t){return n._resolveSkin(e,t)}))),e.scenes&&(e.scenes=e.scenes.map((function(e,t){return n._resolveScene(e,t)}))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])},t.getScene=function(e){return this._get("scenes",e)},t.getNode=function(e){return this._get("nodes",e)},t.getSkin=function(e){return this._get("skins",e)},t.getMesh=function(e){return this._get("meshes",e)},t.getMaterial=function(e){return this._get("materials",e)},t.getAccessor=function(e){return this._get("accessors",e)},t.getCamera=function(e){return null},t.getTexture=function(e){return this._get("textures",e)},t.getSampler=function(e){return this._get("samplers",e)},t.getImage=function(e){return this._get("images",e)},t.getBufferView=function(e){return this._get("bufferViews",e)},t.getBuffer=function(e){return this._get("buffers",e)},t._get=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find "+e+"["+t+"]"),n},t._resolveScene=function(e,t){var n=this;return e.id=e.id||"scene-"+t,e.nodes=(e.nodes||[]).map((function(e){return n.getNode(e)})),e},t._resolveNode=function(e,t){var n=this;return e.id=e.id||"node-"+t,e.children&&(e.children=e.children.map((function(e){return n.getNode(e)}))),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e},t._resolveSkin=function(e,t){return e.id=e.id||"skin-"+t,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e},t._resolveMesh=function(e,t){var n=this;return e.id=e.id||"mesh-"+t,e.primitives&&(e.primitives=e.primitives.map((function(e){var t=(e=Object.assign({},e)).attributes;for(var r in e.attributes={},t)e.attributes[r]=n.getAccessor(t[r]);return void 0!==e.indices&&(e.indices=n.getAccessor(e.indices)),void 0!==e.material&&(e.material=n.getMaterial(e.material)),e}))),e},t._resolveMaterial=function(e,t){if(e.id=e.id||"material-"+t,e.normalTexture&&(e.normalTexture=Object.assign({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=Object.assign({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=Object.assign({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){e.pbrMetallicRoughness=Object.assign({},e.pbrMetallicRoughness);var n=e.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=Object.assign({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=Object.assign({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return e},t._resolveAccessor=function(e,t){var n,r;if(e.id=e.id||"accessor-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(n=e.componentType,he[n]),e.components=(r=e.type,le[r]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var i=e.bufferView.buffer,s=S(e,e.bufferView),a=s.ArrayType,o=s.length,u=(e.bufferView.byteOffset||0)+i.byteOffset;e.value=new a(i.arrayBuffer,u,o)}return e},t._resolveTexture=function(e,t){return e.id=e.id||"texture-"+t,e.sampler="sampler"in e?this.getSampler(e.sampler):me,e.source=this.getImage(e.source),e},t._resolveSampler=function(e,t){for(var n in e.id=e.id||"sampler-"+t,e.parameters={},e){var r=this._enumSamplerParameter(n);void 0!==r&&(e.parameters[r]=e[n])}return e},t._enumSamplerParameter=function(e){return pe[e]},t._resolveImage=function(e,t){e.id=e.id||"image-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var n=this.images[t];return n&&(e.image=n),e},t._resolveBufferView=function(e,t){e.id=e.id||"bufferView-"+t;var n=e.buffer;e.buffer=this.buffers[n];var r=this.buffers[n].arrayBuffer,i=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(r,i,e.byteLength),e},t._resolveCamera=function(e,t){return e.id=e.id||"camera-"+t,e.perspective,e.orthographic,e},e}();function ge(e,t){return(new ve).postProcess(e,t)}function be(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function _e(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){be(s,r,i,a,o,"next",e)}function o(e){be(s,r,i,a,o,"throw",e)}a(void 0)}))}}function ye(e,t,n,r,i){return xe.apply(this,arguments)}function xe(){return(xe=_e(u.a.mark((function e(t,n,r,i,s){var a,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=0),Ae(t,n,r,i),a=[],i.gltf.loadImages&&(o=Te(t,i,s),a.push(o)),!i.gltf.loadBuffers){e.next=7;break}return e.next=7,Se(t,i,s);case 7:return c=re(t,i,s),a.push(c),e.next=11,Promise.all(a);case 11:return e.abrupt("return",i.gltf.postProcess?ge(t,i):t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e,t,n,r){(r.uri&&(e.baseUri=r.uri),t instanceof ArrayBuffer&&!oe(t,n,r))&&(t=(new TextDecoder).decode(t));if("string"==typeof t)e.json=Object(f.a)(t);else if(t instanceof ArrayBuffer){var i={};n=ue(i,t,n,r),h("glTF"===i.type,"Invalid GLB magic string "+i.type),e._glb=i,e.json=i.json}else h(!1,"GLTF: must be ArrayBuffer or string");var s=e.json.buffers||[];if(e.buffers=new Array(s.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var a=e._glb.binChunks;e.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}var o=e.json.images||[];e.images=new Array(o.length).fill({})}function Se(e,t,n){return Oe.apply(this,arguments)}function Oe(){return(Oe=_e(u.a.mark((function e(t,n,r){var i,s,a,o,c,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.json.buffers.length)){e.next=18;break}if(!(s=t.json.buffers[i]).uri){e.next=15;break}return h(a=r.fetch),o=d(s.uri,n),e.next=9,a(o);case 9:return c=e.sent,e.next=12,c.arrayBuffer();case 12:f=e.sent,t.buffers[i]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete s.uri;case 15:++i,e.next=1;break;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e,t,n){return Re.apply(this,arguments)}function Re(){return(Re=_e(u.a.mark((function e(t,n,r){var i,s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.json.images||[],s=[],a=0;a<i.length;++a)s.push(Ee(t,i[a],a,n,r));return e.next=5,Promise.all(s);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e,t,n,r,i){return we.apply(this,arguments)}function we(){return(we=_e(u.a.mark((function e(t,n,r,i,s){var a,o,f,m,v,g,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.fetch,o=s.parse,!n.uri){e.next=9;break}return m=d(n.uri,i),e.next=5,a(m);case 5:return v=e.sent,e.next=8,v.arrayBuffer();case 8:f=e.sent;case 9:return Number.isFinite(n.bufferView)&&(g=p(t.json,t.buffers,n.bufferView),f=Object(l.b)(g.buffer,g.byteOffset,g.byteLength)),h(f,"glTF image has no data"),e.next=13,o(f,c.a,{},s);case 13:b=e.sent,t.images[r]=b;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e,t,n,r,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function je(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){Ie(s,r,i,a,o,"next",e)}function o(e){Ie(s,r,i,a,o,"throw",e)}a(void 0)}))}}var Ce={id:"gltf",name:"glTF",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",extensions:["gltf","glb"],mimeType:"model/gltf+json",text:!0,binary:!0,test:"glTF",parse:function(e,t,n){return Me.apply(this,arguments)},options:{gltf:{loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},uri:"",log:console}};t.a=Ce;function Me(){return(Me=je(u.a.mark((function e(t,n,r){var i,s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),(n=Object.assign({},Ce.options,n)).gltf=Object.assign({},Ce.options.gltf,n.gltf),Ne(n),i=n.byteOffset,s=void 0===i?0:i,a={},e.next=8,ye(a,t,s,n,r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e){"fetchImages"in e&&(e.gltf.loadImages=e.fetchImages),"createImages"in e&&(e.gltf.loadImages=e.createImages),"fetchLinkedResources"in e&&(e.gltf.fetchBuffers=e.fetchLinkedResources),"decompress"in e&&(e.gltf.decompressMeshes=e.decompress),"decompress"in e.gltf&&(e.gltf.decompressMeshes=e.gltf.decompress),"postProcess"in e&&(e.gltf.postProcess=e.postProcess)}}}]);