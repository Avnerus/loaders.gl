(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{232:function(t,e,n){n(247)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},238:function(t,e,n){n(247)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},239:function(t,e,n){n(247)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},261:function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},262:function(t,e,n){"use strict";var r=n(38),i=n(15),a=n(46),u=n(133),s=n(129),o=n(27),c=n(380),h=n(130);i(i.S+i.F*!n(126)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,l=a(t),v="function"==typeof this?this:Array,d=arguments.length,y=d>1?arguments[1]:void 0,m=void 0!==y,p=0,g=h(l);if(m&&(y=r(y,d>2?arguments[2]:void 0,2)),null==g||v==Array&&s(g))for(n=new v(e=o(l.length));e>p;p++)c(n,p,m?y(l[p],p):l[p]);else for(f=g.call(l),n=new v;!(i=f.next()).done;p++)c(n,p,m?u(f,y,[i.value,p],!0):i.value);return n.length=p,n}})},270:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"d",function(){return u}),n.d(e,"e",function(){return c}),n.d(e,"c",function(){return h});var r={};function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function a(t){return Math.round(t/r.EPSILON)*r.EPSILON}function u(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===e?r.precision||4:e;return t=a(t),parseFloat(t.toPrecision(n))}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function o(t,e){if(s(t)){for(var n=(i=t).clone?i.clone():new Array(i),r=0;r<n.length;++r)n[r]=e(n[r],r,n);return n}var i;return e(t)}function c(t){return o(t,function(t){return t/180*Math.PI})}function h(t,e){if(s(t)&&s(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!h(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}r.EPSILON=1e-12,r.debug=!0,r.precision=4,r.printTypes=!1,r.printDegrees=!1,r.printRowMajor=!0},283:function(t,e,n){"use strict";var r=n(317),i=n(300);t.exports=n(318)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},285:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"c",function(){return a});var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,a=Math.random;Math.PI},302:function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(198),i=n(199),a=n(201),u=n(200),s=n(202),o=n(326),c=n(270),h=function(t,e){if(!t)throw new Error(e)},f=function(t){function e(){return Object(r.a)(this,e),Object(a.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(c.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(c.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=0;a<this.ELEMENTS;++a)this[a]+=i[a];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=0;a<this.ELEMENTS;++a)this[a]-=i[a];return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=0;a<this.ELEMENTS;++a)this[a]*=i[a];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=0;a<this.ELEMENTS;++a)this[a]/=i[a];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"scaleAndAdd",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*e+t[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return h(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(c.a)(this[t])}},{key:"setComponent",value:function(t,e){return h(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(c.a)(t)}}]),e}(o.a)},325:function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"f",function(){return s}),n.d(e,"c",function(){return o}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return h}),n.d(e,"a",function(){return f});var r=n(285);function i(t,e,n){var i=new r.a(3);return i[0]=t,i[1]=e,i[2]=n,i}function a(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function u(t,e,n){var r=e[0],i=e[1],a=e[2],u=n[0],s=n[1],o=n[2];return t[0]=i*o-a*s,t[1]=a*u-r*o,t[2]=r*s-i*u,t}function s(t,e,n){var r=e[0],i=e[1],a=e[2],u=n[3]*r+n[7]*i+n[11]*a+n[15];return u=u||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/u,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/u,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/u,t}function o(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function c(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function h(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function f(t,e){var n=i(t[0],t[1],t[2]),r=i(e[0],e[1],e[2]);a(n,n),a(r,r);var u=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(n,r);return u>1?0:u<-1?Math.PI:Math.acos(u)}var l,v;l=new r.a(3),r.a!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),v=l},326:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(198),i=n(199),a=n(201),u=n(200),s=n(202),o=n(270);var c=function(t){function e(){return Object(r.a)(this,e),Object(a.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:"set",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toString",value:function(){return this.formatString(o.b)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(o.d)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(o.c)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"inverse",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"validate",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=t&&t.length===this.ELEMENTS,n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(t[n]);return e}},{key:"check",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;if(o.b.debug&&!this.validate(t))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){return this.scale(t)}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}}]),e}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array))},380:function(t,e,n){"use strict";var r=n(21),i=n(48);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},382:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(198),i=n(199),a=n(201),u=n(200),s=n(202),o=n(302),c=n(270),h=n(325),f=[0,0,0],l=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,e),t=Object(a.a)(this,Object(u.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i,s),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"angle",value:function(t){return h.a(this,t)}},{key:"cross",value:function(t){return h.b(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?f:n;return h.c(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?f:n;return h.d(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?f:n;return h.e(this,this,r,e),this.check()}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(c.a)(t)}}]),e}(o.a)},388:function(t,e,n){"use strict";var r=n(198),i=n(199),a=n(407),u=n(204),s=n(201),o=n(200),c=n(202),h=n(296),f=n(244),l=n(255);var v=n(254),d=n(258);function y(){var t=new l.a(4);return l.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function m(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function p(t,e,n){var r=e[0],i=e[1],a=e[2],u=e[3],s=n[0],o=n[1],c=n[2],h=n[3];return t[0]=r*h+u*s+i*c-a*o,t[1]=i*h+u*o+a*s-r*c,t[2]=a*h+u*c+r*o-i*s,t[3]=u*h-r*s-i*o-a*c,t}function g(t,e,n,r){var i,a,u,s,o,c=e[0],h=e[1],f=e[2],v=e[3],d=n[0],y=n[1],m=n[2],p=n[3];return(a=c*d+h*y+f*m+v*p)<0&&(a=-a,d=-d,y=-y,m=-m,p=-p),1-a>l.b?(i=Math.acos(a),u=Math.sin(i),s=Math.sin((1-r)*i)/u,o=Math.sin(r*i)/u):(s=1-r,o=r),t[0]=s*c+o*d,t[1]=s*h+o*y,t[2]=s*f+o*m,t[3]=s*v+o*p,t}function E(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,u=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*u+u]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+u]-e[3*u+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[u]=(e[3*u+i]+e[3*i+u])*n}return t}d.b,d.g,d.c;var k,M,b,A,S,O,T,_=d.m,N=d.a,w=d.l,L=d.d,x=d.i,j=d.h,R=d.n,P=d.k,I=(d.f,d.e,k=v.b(),M=v.e(1,0,0),b=v.e(0,1,0),function(t,e,n){var r=v.d(e,n);return r<-.999999?(v.c(k,M,e),v.f(k)<1e-6&&v.c(k,b,e),v.i(k,k),m(t,k,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(v.c(k,e,n),t[0]=k[0],t[1]=k[1],t[2]=k[2],t[3]=1+r,P(t,t))}),C=(A=y(),S=y(),O=new l.a(9),l.a!=Float32Array&&(O[1]=0,O[2]=0,O[3]=0,O[5]=0,O[6]=0,O[7]=0),O[0]=1,O[4]=1,O[8]=1,T=O,[0,0,0,1]);var B=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(r.a)(this,e),t=Object(s.a)(this,Object(o.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i,a,u),t}return Object(c.a)(e,t),Object(i.a)(e,[{key:"fromMatrix3",value:function(t){return E(this,t),this.check()}},{key:"fromValues",value:function(t,e,n,r){return this.set(t,e,n,r)}},{key:"identity",value:function(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}},{key:"length",value:function(){return j(this)}},{key:"squaredLength",value:function(t){return R(this)}},{key:"dot",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return L(this,t)}},{key:"rotationTo",value:function(t,e){return I(this,t,e),this.check()}},{key:"add",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return N(this,t),this.check()}},{key:"calculateW",value:function(){var t,e,n,r,i;return t=this,n=(e=this)[0],r=e[1],i=e[2],t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),this.check()}},{key:"conjugate",value:function(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}},{key:"invert",value:function(){var t,e,n,r,i,a,u,s;return t=this,n=(e=this)[0],r=e[1],i=e[2],a=e[3],s=(u=n*n+r*r+i*i+a*a)?1/u:0,t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,this.check()}},{key:"lerp",value:function(t,e,n){return x(this,t,e,n),this.check()}},{key:"multiply",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.multiply only takes one argument");return p(this,this,t),this.check()}},{key:"normalize",value:function(){return P(this,this),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],u=e[3],s=Math.sin(n),o=Math.cos(n);t[0]=r*o+u*s,t[1]=i*o+a*s,t[2]=a*o-i*s,t[3]=u*o-r*s}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],u=e[3],s=Math.sin(n),o=Math.cos(n);t[0]=r*o-a*s,t[1]=i*o+u*s,t[2]=a*o+r*s,t[3]=u*o-i*s}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],u=e[3],s=Math.sin(n),o=Math.cos(n);t[0]=r*o+i*s,t[1]=i*o-r*s,t[2]=a*o+u*s,t[3]=u*o-a*s}(this,this,t),this.check()}},{key:"scale",value:function(t){return w(this,this,t),this.check()}},{key:"set",value:function(t,e,n,r){return _(this,t,e,n,r),this.check()}},{key:"setAxisAngle",value:function(t,e){return m(this,t,e),this.check()}},{key:"slerp",value:function(t){var e=t.start;return g(this,void 0===e?C:e,t.target,t.ratio),this.check()}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(f.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(f.a)(t)}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(f.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){return this[3]=Object(f.a)(t)}}]),e}(h.a),F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},V={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function U(t){if(!t._animation){var e=V[t.componentType],n=F[t.type],r=n*t.count,i=t.bufferView.data,a=new e(i.buffer,i.byteOffset+(t.byteOffset||0),r);if(1===n)t._animation=Array.from(a);else{for(var u=[],s=0;s<a.length;s+=n)u.push(Array.from(a.slice(s,s+n)));t._animation=u}}return t._animation}var q=new a.a;var D=new B;function H(t,e,n,r){var i=e.input,a=e.interpolation,s=e.output,o=t%i[i.length-1],c=i.findIndex(function(t){return t>=o}),h=Math.max(0,c-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:u.B.warn("Bad animation path ".concat(r))()}Object(u.s)(n[r].length===s[h].length);var f=i[h],l=i[c];switch(a){case"STEP":!function(t,e,n){for(var r=0;r<n.length;r++)t[e][r]=n[r]}(n,r,s[h]);break;case"LINEAR":if(l>f){var v=(o-f)/(l-f);!function(t,e,n,r,i){if("rotation"===e){D.slerp({start:n,target:r,ratio:i});for(var a=0;a<D.length;a++)t[e][a]=D[a]}else for(var u=0;u<n.length;u++)t[e][u]=i*r[u]+(1-i)*n[u]}(n,r,s[h],s[c],v)}break;case"CUBICSPLINE":if(l>f){var d=(o-f)/(l-f),y=l-f;!function(t,e,n){for(var r=n.p0,i=n.outTangent0,a=n.inTangent1,u=n.p1,s=n.tDiff,o=n.ratio,c=0;c<t[e].length;c++){var h=i[c]*s,f=a[c]*s;t[e][c]=(2*Math.pow(o,3)-3*Math.pow(o,2)+1)*r[c]+(Math.pow(o,3)-2*Math.pow(o,2)+o)*h+(-2*Math.pow(o,3)+3*Math.pow(o,2))*u[c]+(Math.pow(o,3)-Math.pow(o,2))*f}}(n,r,{p0:s[3*h+1],outTangent0:s[3*h+2],inTangent1:s[3*c+0],p1:s[3*c+1],tDiff:y,ratio:d})}break;default:u.B.warn("Interpolation ".concat(a," not supported"))()}}var G=function(){function t(e){Object(r.a)(this,t),this.startTime=0,this.playing=!0,this.speed=1,Object.assign(this,e)}return Object(i.a)(t,[{key:"animate",value:function(t){if(this.playing){var e=(t/1e3-this.startTime)*this.speed;this.channels.forEach(function(t){var n=t.sampler,r=t.target,i=t.path;H(e,n,r,i),function(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){var n=q.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(r,r._node)})}}}]),t}(),X=function(){function t(e){Object(r.a)(this,t),this.animations=e.animations.map(function(t,n){var r=t.name||"Animation-".concat(n),i=t.samplers.map(function(t){var n=t.input,r=t.interpolation,i=void 0===r?"LINEAR":r,a=t.output;return{input:U(e.accessors[n]),interpolation:i,output:U(e.accessors[a])}}),a=t.channels.map(function(t){var n=t.sampler,r=t.target;return{sampler:i[n],target:e.nodes[r.node],path:r.path}});return new G({name:r,channels:a})})}return Object(i.a)(t,[{key:"animate",value:function(t){this.animations.forEach(function(e){return e.animate(t)})}},{key:"getAnimations",value:function(){return this.animations}}]),t}(),z=n(240),Q=n(207),Y=function(){function t(e,n){var i=n.attributes,a=n.material,u=n.pbrDebug,s=n.imageBasedLightingEnvironment,o=n.lights;Object(r.a)(this,t),this.gl=e,this.defines={USE_TEX_LOD:1,MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),u&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(u,"PBR_DEBUG"),a&&this.parseMaterial(a)}return Object(i.a)(t,[{key:"defineIfPresent",value:function(t,e){t&&(this.defines[e]=1)}},{key:"parseTexture",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},i=new u.n(this.gl,{id:t.name||t.id,parameters:r,pixelStore:Object(Q.a)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1),data:t.texture.source.getImageAsync()});this.uniforms[e]=i,this.defineIfPresent(n,n),this.generatedTextures.push(i)}},{key:"parsePbrMetallicRoughness",value:function(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var e=t.metallicFactor,n=void 0===e?1:e,r=t.roughnessFactor,i=void 0===r?1:r;this.uniforms.u_MetallicRoughnessValues=[n,i]}},{key:"parseMaterial",value:function(t){if(t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var e=t.normalTexture.scale,n=void 0===e?1:e;this.uniforms.u_NormalScale=n}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var r=t.occlusionTexture.strength,i=void 0===r?1:r;this.uniforms.u_OcclusionStrength=i}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),"MASK"===t.alphaMode){var a=t.alphaCutoff,s=void 0===a?.5:a;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=s}else"BLEND"===t.alphaMode&&(u.B.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}]),t}(),J="\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n",K="\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n";function W(t,e){return Object(u.z)(t)?"#version 300 es\n".concat(e):e}var Z={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0},tt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,t),this.gl=e,this.options=Object.assign({},$,n)}return Object(i.a)(t,[{key:"instantiate",value:function(t){var e=this;return this.gltf=t,(t.scenes||[]).map(function(t){return e.createScene(t)})}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new X(this.gltf):null}},{key:"createScene",value:function(t){var e=this,n=(t.nodes||[]).map(function(t){return e.createNode(t)});return new u.h({id:t.name||t.id,children:n})}},{key:"createNode",value:function(t){var e=this;if(!t._node){var n=(t.children||[]).map(function(t){return e.createNode(t)});t.mesh&&n.push(this.createMesh(t.mesh));var r=new u.h({id:t.name||t.id,children:n});if(t.matrix)r.setMatrix(t.matrix);else{if(r.matrix.identity(),t.translation&&r.matrix.translate(t.translation),t.rotation){var i=(new a.a).fromQuaternion(t.rotation);r.matrix.multiplyRight(i)}t.scale&&r.matrix.scale(t.scale)}t._node=r}return t._node}},{key:"createMesh",value:function(t){var e=this;if(!t._mesh){var n=(t.primitives||[]).map(function(n,r){return e.createPrimitive(n,r,t)}),r=new u.h({id:t.name||t.id,children:n});t._mesh=r}return t._mesh}},{key:"getVertexCount",value:function(t){u.B.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(t,e,n){return function(t,e){var n=e.id,r=e.drawMode,i=e.vertexCount,a=e.attributes,s=e.modelOptions,o=new Y(t,e);u.B.info(4,"createGLTFModel defines: ",o.defines)();var c=[];c.push.apply(c,Object(z.a)(o.generatedTextures)),c.push.apply(c,Object(z.a)(Object.values(a).map(function(t){return t.buffer})));var h=new u.j(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[u.D],defines:o.defines,parameters:o.parameters,vs:W(t,J),fs:W(t,K),managedResources:c},s));return h.setProps({attributes:a}),h.setUniforms(o.uniforms),h}(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options))}},{key:"createAttributes",value:function(t,e){var n=this,r={};return Object.keys(t).forEach(function(e){r[e]=n.createAccessor(t[e],n.createBuffer(t[e],n.gl.ARRAY_BUFFER))}),e&&(r.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),u.B.info(4,"glTF Attributes",{attributes:t,indices:e,generated:r})(),r}},{key:"createBuffer",value:function(t,e){t.bufferView||(t.bufferView={});var n=t.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new u.c(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}},{key:"createAccessor",value:function(t,e){return new u.q({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:Z[t.type]})}},{key:"createSampler",value:function(t){return t}},{key:"needsPOT",value:function(){return!1}}]),t}();function et(t,e,n){var r=new tt(t,n);return{scenes:r.instantiate(e),animator:r.createAnimator()}}n.d(e,"a",function(){return et})}}]);