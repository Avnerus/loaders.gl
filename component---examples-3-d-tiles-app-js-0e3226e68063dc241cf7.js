(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{287:function(e,t,n){"use strict";n.r(t);n(24),n(3),n(39),n(4);var r=n(296),i=n.n(r),a=(n(297),n(0)),s=n.n(a),o=n(96),u=n(616),c=n(655),l=n(497),h=n(437),f=n(623),d=n(663),p=(n(10),n(7),n(5),n(6),n(134),n(131),n(391),n(591)),y=n(592),m=n(593),v=n(594),_=n.n(v),g=(n(291),n(133),n(490)),b=n.n(g),T=n(595),w=n.n(T),x=n(596);function I(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function E(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){I(a,r,i,s,o,"next",e)}function o(e){I(a,r,i,s,o,"throw",e)}s(void 0)})}}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(e,t){this._url=e,this._ok=!0,this._status=200,this.options=t,this.bodyUsed=!1,this._headers=null}var t,n,r,a=e.prototype;return a.arrayBuffer=function(){var e=E(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.bodyUsed=!0,e.abrupt("return",Object(x.b)(this.url,this.options));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),a.text=function(){var e=E(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.arrayBuffer();case 2:return t=e.sent,n=new TextDecoder,e.abrupt("return",n.decode(t));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),a.json=function(){var e=E(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.text();case 2:return t=e.sent,e.abrupt("return",JSON.parse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),a._getHeaders=function(){var e={};if(this.httpResponse){var t=this.httpResponse.getHeaders();for(var n in t){var r=e[n];e[n]=String(r)}}else{var i=this._getContentLength();Number.isFinite(i)&&(e["Content-Length"]=i)}return new w.a(e)},a._getContentLength=function(){return(e=this.url).startsWith("http:")||e.startsWith("https:")?null:function(e){return e.startsWith("data:")}(this.url)?this.url.length-"data:".length:b.a.statSync(this.url).size;var e},t=e,(n=[{key:"ok",get:function(){return this._ok}},{key:"status",get:function(){return this._status}},{key:"url",get:function(){return this._url}},{key:"headers",get:function(){this._headers=this._headers||this._getHeaders()}},{key:"body",get:function(){var e=this.url,t=this.options;return this.bodyUsed=!0,Object(x.a)(e,t)}}])&&S(t.prototype,n),r&&S(t,r),e}(),A=n(603),k=n.n(A),N=n(604),C=n(605);"TextEncoder"in p.a||!y.b||(p.a.TextEncoder=y.b),"TextDecoder"in p.a||!y.a||(p.a.TextDecoder=y.a),p.b||"atob"in p.a||!m.atob||(p.a.atob=m.atob),p.b||"btoa"in p.a||!m.btoa||(p.a.btoa=m.btoa),p.b||"Headers"in p.a||!_.a||(p.a.Headers=_.a),p.b||"Response"in p.a||!O||(p.a.Respone=O),p.b||"fetch"in p.a||!k.a||(p.a.fetch=k.a),p.b||"_encodeImageNode"in p.a||!N.encodeImageNode||(p.a._encodeImageNode=N.encodeImageNode),p.b||"_parseImageNode"in p.a||!C.parseImageNode||(p.a._parseImageNode=C.parseImageNode);var L=n(367),P=n(496),D=n(657),M=n(656),U=n(327),R=n(316),B=(n(8),{COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"}),F=(Object.keys(B),{UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5}),j={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0},V=0,G=1,q=(n(295),n(319));function z(e,t,n){Object(q.a)(e instanceof ArrayBuffer);var r=new TextDecoder("utf8"),i=new Uint8Array(e,t,n);return r.decode(i)}function H(e,t){void 0===t&&(t=0);var n=new DataView(e);return""+String.fromCharCode(n.getUint8(t+0))+String.fromCharCode(n.getUint8(t+1))+String.fromCharCode(n.getUint8(t+2))+String.fromCharCode(n.getUint8(t+3))}var J=n(542),W={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Y=Object.assign({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},{},W);function Q(e,t){if(!e)throw new Error(t||"3d-tile loader: assertion failed.")}n(318),n(321),n(322),n(312),n(314),n(299),n(363);var Z,K=((Z={})[W.DOUBLE]=Float64Array,Z[W.FLOAT]=Float32Array,Z[W.UNSIGNED_SHORT]=Uint16Array,Z[W.UNSIGNED_INT]=Uint32Array,Z[W.UNSIGNED_BYTE]=Uint8Array,Z[W.BYTE]=Int8Array,Z[W.SHORT]=Int16Array,Z[W.INT]=Int32Array,Z),X={DOUBLE:W.DOUBLE,FLOAT:W.FLOAT,UNSIGNED_SHORT:W.UNSIGNED_SHORT,UNSIGNED_INT:W.UNSIGNED_INT,UNSIGNED_BYTE:W.UNSIGNED_BYTE,BYTE:W.BYTE,SHORT:W.SHORT,INT:W.INT},$=function(){function e(){}return e.fromTypedArray=function(e){for(var t in e=ArrayBuffer.isView(e)?e.constructor:e,K){if(K[t]===e)return t}throw new Error("Failed to convert GL type")},e.fromName=function(e){var t=X[e];if(!t)throw new Error("Failed to convert GL type");return t},e.getArrayType=function(e,t){switch(void 0===t&&(t=!1),e){case W.UNSIGNED_SHORT_5_6_5:case W.UNSIGNED_SHORT_4_4_4_4:case W.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var n=K[e];if(!n)throw new Error("Failed to convert GL type");return n}},e.getByteSize=function(t){return e.getArrayType(t).BYTES_PER_ELEMENT},e.validate=function(t){return Boolean(e.getArrayType(t))},e.createTypedArray=function(t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=(n.byteLength-r)/e.getByteSize(t)),new(e.getArrayType(t))(n,r,i)},e}(),ee=function(){function e(e,t){this.json=e,this.buffer=t,this.featuresLength=0,this._cachedTypedArrays={}}var t=e.prototype;return t.getExtension=function(e){return this.json.extensions&&this.json.extensions[e]},t.hasProperty=function(e){return Boolean(this.json[e])},t.getGlobalProperty=function(e,t,n){void 0===t&&(t=Y.UNSIGNED_INT),void 0===n&&(n=1);var r=this.json[e];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,r.byteOffset):r},t.getPropertyArray=function(e,t,n){var r=this.json[e];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(t=$.fromName(r.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(e,t,r)},t.getProperty=function(e,t,n,r,i){var a=this.json[e];if(!a)return a;var s=this.getPropertyArray(e,t,n);if(1===n)return s[r];for(var o=0;o<n;++o)i[o]=s[n*r+o];return i},t._getTypedArrayFromBinary=function(e,t,n,r,i){var a=this._cachedTypedArrays,s=a[e];return s||(s=$.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+i,r*n),a[e]=s),s},t._getTypedArrayFromArray=function(e,t,n){var r=this._cachedTypedArrays,i=r[e];return i||(i=$.createTypedArray(t,n),r[e]=i),i},e}(),te=(n(56),n(76),n(32),{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),ne={SCALAR:function(e,t){return e[t]},VEC2:function(e,t){return[e[2*t+0],e[2*t+1]]},VEC3:function(e,t){return[e[3*t+0],e[3*t+1],e[3*t+2]]},VEC4:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT2:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT3:function(e,t){return[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]]},MAT4:function(e,t){return[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]}},re={SCALAR:function(e,t,n){t[n]=e},VEC2:function(e,t,n){t[2*n+0]=e[0],t[2*n+1]=e[1]},VEC3:function(e,t,n){t[3*n+0]=e[0],t[3*n+1]=e[1],t[3*n+2]=e[2]},VEC4:function(e,t,n){t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT2:function(e,t,n){t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT3:function(e,t,n){t[9*n+0]=e[0],t[9*n+1]=e[1],t[9*n+2]=e[2],t[9*n+3]=e[3],t[9*n+4]=e[4],t[9*n+5]=e[5],t[9*n+6]=e[6],t[9*n+7]=e[7],t[9*n+8]=e[8],t[9*n+9]=e[9]},MAT4:function(e,t,n){t[16*n+0]=e[0],t[16*n+1]=e[1],t[16*n+2]=e[2],t[16*n+3]=e[3],t[16*n+4]=e[4],t[16*n+5]=e[5],t[16*n+6]=e[6],t[16*n+7]=e[7],t[16*n+8]=e[8],t[16*n+9]=e[9],t[16*n+10]=e[10],t[16*n+11]=e[11],t[16*n+12]=e[12],t[16*n+13]=e[13],t[16*n+14]=e[14],t[16*n+15]=e[15]}};n(360);function ie(e){throw new Error('"'+e+'" is read-only')}var ae=function(e){return void 0!==e};function se(e,t,n){if(!t)return null;var r=e.getExtension("3DTILES_batch_table_hierarchy"),i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(e,t){var n,r,i,a,s=e.instancesLength,o=e.classes,u=e.classIds,c=e.parentCounts,l=e.parentIds,h=s;ae(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),ie("classIds"),u=i.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,s));if(ae(c))for(ae(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),ie("parentCounts"),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,s)),a=new Uint16Array(s),ie("parentIdsLength"),h=0,n=0;n<s;++n)a[n]=h,h+=(ie("parentIdsLength"),c[n]);ae(l)&&ae(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),ie("parentIds"),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,h));var f=o.length;for(n=0;n<f;++n){var d=o[n].length,p=o[n].instances,y=getBinaryProperties(d,p,t);o[n].instances=combine(y,p)}var m=new Array(f).fill(0),v=new Uint16Array(s);for(n=0;n<s;++n)r=u[n],v[n]=m[r],++m[r];var _={classes:o,classIds:u,classIndexes:v,parentCounts:c,parentIndexes:a,parentIds:l};return function(e){for(var t=e.classIds.length,n=0;n<t;++n)ue(e,n,stack)}(_),_}(r,n):null}function oe(e,t,n){if(e){var r=e.parentCounts;return e.parentIds?n(e,t):r>0?function(e,t,n){var r=e.classIds,i=e.parentCounts,a=e.parentIds,s=e.parentIndexes,o=r.length,u=scratchVisited;u.length=Math.max(u.length,o);var c=++marker,l=scratchStack;l.length=0,l.push(t);for(;l.length>0;)if(t=l.pop(),u[t]!==c){u[t]=c;var h=n(e,t);if(ae(h))return h;for(var f=i[t],d=s[t],p=0;p<f;++p){var y=a[d+p];y!==t&&l.push(y)}}return null}(e,t,n):function(e,t,n){var r=!0;for(;r;){var i=n(e,t);if(ae(i))return i;var a=e.parentIds[t];r=a!==t,t=a}throw new Error("traverseHierarchySingleParent")}(e,t,n)}}function ue(e,t,n){var r=e.parentCounts,i=e.parentIds,a=e.parentIndexes,s=e.classIds.length;if(ae(i)){assert(t<s,"Parent index "+t+" exceeds the total number of instances: "+s),assert(-1===n.indexOf(t),"Circular dependency detected in the batch table hierarchy."),n.push(t);for(var o=ae(r)?r[t]:1,u=ae(r)?a[t]:t,c=0;c<o;++c){var l=i[u+c];l!==t&&ue(e,l,n)}n.pop(t)}}function ce(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var le=function(e){return void 0!==e},he=function(e){return e},fe={HIERARCHY:!0,extensions:!0,extras:!0},de=function(){function e(e,t,n,r){for(var i in void 0===r&&(r={}),Q(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=this.json&&this.json.extensions||{},this._properties={},this.json)fe[i]||(this._properties[i]=this.json[i]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=se(this,this.json,this.binary))}var t=e.prototype;return t.getExtension=function(e){return this.json&&this.json.extensions&&this.json.extensions[e]},t.memorySizeInBytes=function(){return 0},t.isClass=function(e,t){if(this._checkBatchId(e),Q("string"==typeof t,t),this._hierarchy){var n=oe(this._hierarchy,e,function(e,n){var r=e.classIds[n];return e.classes[r].name===t});return le(n)}return!1},t.isExactClass=function(e,t){return Q("string"==typeof t,t),this.getExactClassName(e)===t},t.getExactClassName=function(e){if(this._checkBatchId(e),this._hierarchy){var t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}},t.hasProperty=function(e,t){return this._checkBatchId(e),Q("string"==typeof t,t),le(this._properties[t])||this._hasPropertyInHierarchy(e,t)},t.getPropertyNames=function(e,t){var n;this._checkBatchId(e),(t=le(t)?t:[]).length=0;var r=Object.keys(this._properties);return(n=t).push.apply(n,ce(r)),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t},t.getProperty=function(e,t){if(this._checkBatchId(e),Q("string"==typeof t,t),this._binaryProperties){var n=this._binaryProperties[t];if(le(n))return this._getBinaryProperty(n,e)}var r=this._properties[t];if(le(r))return he(r[e]);if(this._hierarchy){var i=this._getHierarchyProperty(e,t);if(le(i))return i}},t.setProperty=function(e,t,n){var r=this.featureCount;if(this._checkBatchId(e,r),Q("string"==typeof t,t),this._binaryProperties){var i=this._binaryProperties[t];if(i)return void this._setBinaryProperty(i,e,n)}if(!this._hierarchy||!this._setHierarchyProperty(this,e,t,n)){var a=this._properties[t];le(a)||(this._properties[t]=new Array(r),a=this._properties[t]),a[e]=he(n)}},t._checkBatchId=function(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")},t._getBinaryProperty=function(e,t){return e.unpack(e.typedArray,t)},t._setBinaryProperty=function(e,t,n){e.pack(n,e.typedArray,t)},t._initializeBinaryProperties=function(){var e=null;for(var t in this._properties){var n=this._properties[t],r=this._initializeBinaryProperty(t,n);r&&((e=e||{})[t]=r)}return e},t._initializeBinaryProperty=function(e,t){if("byteOffset"in t){var n=t;Q(this.binary,"Property "+e+" requires a batch table binary."),Q(n.type,"Property "+e+" requires a type.");var r=function(e,t,n,r){var i=e.componentType;Q(e.componentType);var a="string"==typeof i?$.fromName(i):i,s=te[e.type],o=ne[e.type],u=re[e.type];return n+=e.byteOffset,{values:$.createTypedArray(a,t,n,s*r),type:a,size:s,unpacker:o,packer:u}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null},t._hasPropertyInHierarchy=function(e,t){if(!this._hierarchy)return!1;var n=oe(this._hierarchy,e,function(e,n){var r=e.classIds[n],i=e.classes[r].instances;return le(i[t])});return le(n)},t._getPropertyNamesInHierarchy=function(e,t){oe(this._hierarchy,e,function(e,n){var r=e.classIds[n],i=e.classes[r].instances;for(var a in i)i.hasOwnProperty(a)&&-1===t.indexOf(a)&&t.push(a)})},t._getHierarchyProperty=function(e,t){var n=this;return oe(this._hierarchy,e,function(e,r){var i=e.classIds[r],a=e.classes[i],s=e.classIndexes[r],o=a.instances[t];return le(o)?le(o.typedArray)?n._getBinaryProperty(o,s):he(o[s]):null})},t._setHierarchyProperty=function(e,t,n,r){var i=this,a=oe(this._hierarchy,t,function(e,a){var s=e.classIds[a],o=e.classes[s],u=e.classIndexes[a],c=o.instances[n];return!!le(c)&&(Q(a===t,'Inherited property "'+n+'" is read-only.'),le(c.typedArray)?i._setBinaryProperty(c,u,r):c[u]=he(r),!0)});return le(a)},e}(),pe=4;function ye(e,t,n){void 0===n&&(n=0);var r=new DataView(t);if(e.magic=r.getUint32(n,!0),n+=pe,e.version=r.getUint32(n,!0),n+=pe,e.byteLength=r.getUint32(n,!0),n+=pe,1!==e.version)throw new Error("3D Tile Version "+e.version+" not supported");return n}var me=4;function ve(e,t,n){var r=new DataView(t);return e.featureTableJsonByteLength=r.getUint32(n,!0),n+=me,e.featureTableBinaryByteLength=r.getUint32(n,!0),n+=me,e.batchTableJsonByteLength=r.getUint32(n,!0),n+=me,e.batchTableBinaryByteLength=r.getUint32(n,!0),n+=me}function _e(e,t,n,r){return n=function(e,t,n,r){var i=e.featureTableJsonByteLength,a=e.featureTableBinaryByteLength;if(e.featureTableJson={BATCH_LENGTH:0},i>0){var s=z(t,n,i);e.featureTableJson=JSON.parse(s)}return n+=i,e.featureTableBinary=new Uint8Array(t,n,a),n+=a}(e,t,n),n=function(e,t,n,r){var i=e.batchTableJsonByteLength,a=e.batchTableBinaryByteLength;if(i>0){var s=z(t,n,i);e.batchTableJson=JSON.parse(s),n+=i,a>0&&(e.batchTableBinary=new Uint8Array(t,n,a),e.batchTableBinary=new Uint8Array(e.batchTableBinary),n+=a)}return n}(e,t,n)}n(362);function ge(e,t){void 0===t&&(t=[0,0,0]);var n=e>>11&31,r=e>>5&63,i=31&e;return t[0]=n<<3,t[1]=r<<2,t[2]=i<<3,t}function be(e,t,n){if(!(t||e&&e.batchIds&&n))return null;var r=e.batchIds,i=e.isRGB565,a=e.pointCount;if(r&&n){for(var s=new Uint8ClampedArray(3*a),o=0;o<a;o++){var u=r[o],c=n.getProperty(u,"dimensions").map(function(e){return 255*e});s[3*o]=c[0],s[3*o+1]=c[1],s[3*o+2]=c[2]}return{size:3,value:s}}if(i){for(var l=new Uint8ClampedArray(3*a),h=0;h<a;h++){var f=ge(t[h]);l[3*h]=f[0],l[3*h+1]=f[1],l[3*h+2]=f[2]}return{size:3,value:l}}return t&&t.length===3*a?{size:3,value:t}:{size:4,value:t}}var Te=n(651),we=n(339);n(650);function xe(e,t){if(!e)throw new Error("math.gl assertion failed. "+t)}new Te.a,new J.a,new Te.a,new Te.a,new Uint8Array(1);function Ie(e,t){return void 0===t&&(t=255),Object(we.a)(e,0,t)/t*2-1}function Ee(e){return e<0?-1:1}function Se(e,t,n,r){if(xe(r),e<0||e>n||t<0||t>n)throw new Error("x and y must be unsigned normalized integers between 0 and "+n);if(r.x=Ie(e,n),r.y=Ie(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){var i=r.x;r.x=(1-Math.abs(r.y))*Ee(i),r.y=(1-Math.abs(i))*Ee(r.y)}return r.normalize()}function Oe(e,t,n){return Se(e,t,255,n)}var Ae=new J.a;var ke=new J.a;function Ne(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ce(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Ne(a,r,i,s,o,"next",e)}function o(e){Ne(a,r,i,s,o,"throw",e)}s(void 0)})}}function Le(e,t,n,r){return Pe.apply(this,arguments)}function Pe(){return(Pe=Ce(i.a.mark(function e(t,n,r,a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=ye(t,n,r),r=ve(t,n,r),r=_e(t,n,r),e.next=5,Me(t,a);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function De(e,t,n,r){return n=_e(e,t,n=ve(e,t,n=ye(e,t,n))),function(e){Re(e);var t=Be(e).featureTable;Fe(e,t),je(e,t),Ve(e,t)}(e),n}function Me(e,t){return Ue.apply(this,arguments)}function Ue(){return(Ue=Ce(i.a.mark(function e(t,n){var r,a,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Re(t),r=Be(t),a=r.featureTable,s=r.batchTable,e.next=4,Ge(t,a,s,n);case 4:Fe(t,a),je(t,a,s),Ve(t,a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Re(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function Be(e){var t=new ee(e.featureTableJson,e.featureTableBinary),n=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=n,e.featuresLength=n,e.pointsLength=n,e.pointCount=n,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",Y.FLOAT,3);var r=function(e,t){var n=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",Y.UNSIGNED_SHORT,1),e.batchIds)){var r=t.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=e.batchTableJson,a=e.batchTableBinary;n=new de(i,a,r)}return n}(e,t);return{featureTable:t,batchTable:r}}function Fe(e,t){if(!e.attributes.positions)if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",Y.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){var n=t.getPropertyArray("POSITION_QUANTIZED",Y.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Y.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Y.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=function(e,t){if(e.isQuantized){for(var n=new Float32Array(3*e.pointCount),r=0;r<e.pointCount;r++)ke.set(t[3*r],t[3*r+1],t[3*r+2]).multiply(e.quantizedVolumeScale).scale(1/e.quantizedRange).add(e.quantizedVolumeOffset),ke.toArray(n,3*r);return n}return t}(e,n)}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function je(e,t,n){if(!e.attributes.colors){var r=null;t.hasProperty("RGBA")?(r=t.getPropertyArray("RGBA",Y.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?r=t.getPropertyArray("RGB",Y.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(r=t.getPropertyArray("RGB565",Y.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=be(e,r,n)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",Y.UNSIGNED_BYTE,4))}function Ve(e,t){if(!e.attributes.normals){var n=null;t.hasProperty("NORMAL")?n=t.getPropertyArray("NORMAL",Y.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(n=t.getPropertyArray("NORMAL_OCT16P",Y.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=function(e,t){if(e.isOctEncoded16P){for(var n=new Float32Array(3*e.pointsLength),r=0;r<e.pointsLength;r++)Oe(t[2*r],t[2*r+1],Ae),Ae.toArray(n,3*r);return n}return t}(e,n)}}function Ge(e,t,n,r){return qe.apply(this,arguments)}function qe(){return(qe=Ce(i.a.mark(function e(t,n,r,a){var s,o,u,c,l,h,f,d;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((c=r&&r.getExtension("3DTILES_draco_point_compression"))&&(u=c.properties),!(l=n.getExtension("3DTILES_draco_point_compression"))){e.next=15;break}if(o=l.properties,h=l.byteOffset,f=l.byteLength,o&&Number.isFinite(h)&&f){e.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:s=t.featureTableBinary.slice(h,h+f),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA);case 15:if(!s){e.next=19;break}return d={buffer:s,properties:Object.assign({},o,{},u),featureTableProperties:o,batchTableProperties:u,dequantizeInShader:!1},e.next=19,ze(t,d,a);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ze(e,t,n){return He.apply(this,arguments)}function He(){return(He=Ce(i.a.mark(function e(t,n,r){var a,s,o,u,c,l,h,f,d;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Q(r.DracoLoader),e.next=3,Object(R.a)(n.buffer,r.DracoLoader);case 3:a=e.sent,s=a.attributes.POSITION&&a.attributes.POSITION.value,o=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,u=a.attributes.NORMAL&&a.attributes.NORMAL.value,c=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,l=s&&a.attributes.POSITION.value.quantization,h=u&&a.attributes.NORMAL.value.quantization,l&&(f=a.POSITION.data.quantization,d=f.range,t.quantizedVolumeScale=new J.a(d,d,d),t.quantizedVolumeOffset=new J.a(f.minValues),t.quantizedRange=(1<<f.quantizationBits)-1,t.isQuantizedDraco=!0),h&&(t.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0),t.attributes={positions:s,colors:be(t,o),normals:u,batchIds:c};case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}n(12);var Je={URI:0,EMBEDDED:1};function We(e,t,n){var r=e.byteOffset+e.byteLength-n;if(0===r)throw new Error("glTF byte length must be greater than 0.");var i=new Uint8Array(t).subarray(n,n+r),a=new Uint8Array(i);return e.gltfArrayBuffer=a.buffer,e.gltfByteOffset=0,e.gltfByteLength=r,e.byteOffset+e.byteLength}function Ye(e,t,n){switch(t){case Je.URI:var r=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),i=(new TextDecoder).decode(r);e.gltfUrl=i.replace(/[\s\0]+$/,"");break;case Je.EMBEDDED:e.gltf={};break;default:throw new Error("i3dm: glTF format "+t+": Must be 0 (uri) or 1 (embedded)")}}function Qe(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ze(e,t,n,r){return Ke.apply(this,arguments)}function Ke(){var e;return e=i.a.mark(function e(t,n,r,a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xe(t,n,r,a));case 1:case"end":return e.stop()}},e)}),(Ke=function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Qe(a,r,i,s,o,"next",e)}function o(e){Qe(a,r,i,s,o,"throw",e)}s(void 0)})}).apply(this,arguments)}function Xe(e,t,n,r){n=We(e,t,n=_e(e,t,n=ve(e,t,n=ye(e,t,n))));var i=new ee(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=i.getGlobalProperty("RTC_CENTER",Y.FLOAT,3),Ye(e,Je.EMBEDDED),n}var $e=n(649),et=n(665),tt=n(637),nt=n(380);function rt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function it(e,t,n,r){return at.apply(this,arguments)}function at(){var e;return e=i.a.mark(function e(t,n,r,a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",st(t,n,r,a));case 1:case"end":return e.stop()}},e)}),(at=function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){rt(a,r,i,s,o,"next",e)}function o(e){rt(a,r,i,s,o,"throw",e)}s(void 0)})}).apply(this,arguments)}function st(e,t,n,r){if(n=ye(e,t,n),1!==e.version)throw new Error("Instanced 3D Model version "+e.version+" is not supported");n=ve(e,t,n);var i=new DataView(t);if(e.gltfFormat=i.getUint32(n,!0),n=We(e,t,n=_e(e,t,n+=4)),0===e.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var a=new ee(e.featureTableJson,e.featureTableBinary),s=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=a.getGlobalProperty("RTC_CENTER",Y.FLOAT,3);new de(e.batchTableJson,e.batchTableBinary,s);return Ye(e,e.gltfFormat),function(e,t,n,r){for(var i=[new Array(r),e._batchTable][0],a=new J.a,s=(new J.a,new J.a,new J.a,new $e.a),o=new et.a,u=new J.a,c={},l=new tt.a,h=[],f=[],d=new J.a,p=new J.a,y=0;y<r;y++){var m=void 0;if(t.hasProperty("POSITION"))m=t.getProperty("POSITION",Y.FLOAT,3,y,a);else if(t.hasProperty("POSITION_QUANTIZED")){m=t.getProperty("POSITION_QUANTIZED",Y.UNSIGNED_SHORT,3,y,a);var v=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Y.FLOAT,3,d);if(!v)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var _=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Y.FLOAT,3,p);if(!_)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var g=0;g<3;g++)m[g]=m[g]/65535*_[g]+v[g]}if(!m)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");a.copy(m),c.translation=a,e.normalUp=t.getProperty("NORMAL_UP",Y.FLOAT,3,y,h),e.normalRight=t.getProperty("NORMAL_RIGHT",Y.FLOAT,3,y,f);if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",Y.UNSIGNED_SHORT,2,h),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",Y.UNSIGNED_SHORT,2,f),e.octNormalUp){if(!e.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}e.eastNorthUp?(nt.a.WGS84.eastNorthUpToFixedFrame(a,l),l.getRotationMatrix3(s)):s.identity()}!1,o.fromMatrix3(s),c.rotation=o,u.set(1,1,1);var b=t.getProperty("SCALE",Y.FLOAT,1,y);Number.isFinite(b)&&u.multiplyByScalar(b);var T=t.getProperty("SCALE_NON_UNIFORM",Y.FLOAT,3,y,h);T&&u.scale(T),c.scale=u;var w=t.getProperty("BATCH_ID",Y.UNSIGNED_SHORT,1,y);void 0===w&&(w=y);var x=(new tt.a).fromQuaternion(c.rotation);l.identity(),l.translate(c.translation),l.multiplyRight(x),l.scale(c.scale);var I=l.clone();i[y]={modelMatrix:I,batchId:w}}e.instances=i}(e,a,0,s),n}function ot(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function ut(e,t,n,r,i){return ct.apply(this,arguments)}function ct(){var e;return e=i.a.mark(function e(t,n,r,a,s){var o,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=ye(t,n,r),o=new DataView(n),t.tilesLength=o.getUint32(r,!0),r+=4,t.tiles=[];case 5:if(!(t.tiles.length<t.tilesLength&&t.byteLength-r>12)){e.next=13;break}return u={},t.tiles.push(u),e.next=10,s(n,r,a,u);case 10:r=e.sent,e.next=5;break;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}},e)}),(ct=function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){ot(a,r,i,s,o,"next",e)}function o(e){ot(a,r,i,s,o,"throw",e)}s(void 0)})}).apply(this,arguments)}function lt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function ht(e,t,n,r){return ft.apply(this,arguments)}function ft(){var e;return e=i.a.mark(function e(t,n,r,a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=0),void 0===r&&(r={}),void 0===a&&(a={}),a.byteOffset=n,a.type=H(t,n),e.t0=a.type,e.next=e.t0===B.COMPOSITE?8:e.t0===B.BATCHED_3D_MODEL?11:e.t0===B.INSTANCED_3D_MODEL?14:e.t0===B.POINT_CLOUD?17:20;break;case 8:return e.next=10,ut(a,t,n,r,ht);case 10:return e.abrupt("return",e.sent);case 11:return e.next=13,Ze(a,t,n,r);case 13:return e.abrupt("return",e.sent);case 14:return e.next=16,it(a,t,n,r);case 16:return e.abrupt("return",e.sent);case 17:return e.next=19,Le(a,t,n,r);case 19:return e.abrupt("return",e.sent);case 20:throw new Error("3DTileLoader: unknown type "+a.type);case 21:case"end":return e.stop()}},e)}),(ft=function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){lt(a,r,i,s,o,"next",e)}function o(e){lt(a,r,i,s,o,"throw",e)}s(void 0)})}).apply(this,arguments)}function dt(e,t,n,r){switch(void 0===t&&(t=0),void 0===n&&(n={}),void 0===r&&(r={}),r.byteOffset=t,r.type=H(e,t),r.type){case B.COMPOSITE:return function(e,t,n,r,i){n=ye(e,t,n);var a=new DataView(t);for(e.tilesLength=a.getUint32(n,!0),n+=4,e.tiles=[];e.tiles.length<e.tilesLength&&e.byteLength-n>12;){var s={};e.tiles.push(s),n=i(t,n,r,s)}return n}(r,e,t,n,dt);case B.BATCHED_3D_MODEL:return Xe(r,e,t);case B.INSTANCED_3D_MODEL:return st(r,e,t);case B.POINT_CLOUD:return De(r,e,t);default:throw new Error("3DTileLoader: unknown type "+r.type)}}function pt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function yt(){var e;return e=i.a.mark(function e(t,n,r,a){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={},e.next=4,ht(t,0,n,s);case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}},e)}),(yt=function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){pt(a,r,i,s,o,"next",e)}function o(e){pt(a,r,i,s,o,"throw",e)}s(void 0)})}).apply(this,arguments)}var mt={name:"3D Tiles",extensions:["cmpt","pnts","b3dm","i3dm"],mimeType:"application/octet-stream",test:["cmpt","pnts","b3dm","i3dm"],parse:function(e,t,n,r){return yt.apply(this,arguments)},parseSync:function(e,t,n,r){var i={};return dt(e,0,t,i),i},binary:!0},vt={name:"3D Tileset",extensions:["json"],testText:function(e){return e.indexOf(!1)},parseTextSync:JSON.parse},_t=(n(340),n(660)),gt=n(315),bt=(n(78),"Queued Requests"),Tt="Active Requests",wt="Cancelled Requests",xt="Queued Requests Ever",It="Active Requests Ever",Et={id:"request-scheduler",throttleRequests:!0,maxRequests:6},St=function(){function e(e){void 0===e&&(e={}),this.props=Object.assign({},e,{},Et),this.requestQueue=[],this.activeRequestCount=0,this.stats=new _t.a({id:e.id}),this.stats.get(bt),this.stats.get(Tt),this.stats.get(wt),this.stats.get(xt),this.stats.get(It)}var t=e.prototype;return t.scheduleRequest=function(e,t){var n=this;if(void 0===t&&(t=function(){return 0}),!this.props.throttleRequests)return Promise.resolve(e);var r=new Promise(function(r,i){n.requestQueue.push({handle:e,callback:t,resolve:r,reject:i})});return this._issueNewRequests(),r},t.startRequest=function(e){this.activeRequestCount++},t.endRequest=function(e){this.activeRequestCount--,this._issueNewRequests()},t.trackRequestPromise=function(e,t){var n=this;this.startRequest(e),t.then(function(){return n.endRequest(e)}).catch(function(){return n.endRequest(e)})},t._issueNewRequests=function(){var e=this;this._updateNeeded=!0,setTimeout(function(){return e._issueNewRequestsAsync()},0)},t._issueNewRequestsAsync=function(){this._updateNeeded=!1;var e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(var t=0;t<e;++t){if(this.requestQueue.length>0)this.requestQueue.shift().resolve(!0)}}},t._updateAllRequests=function(){for(var e=this.requestQueue,t=0;t<e.length;++t){var n=e[t];this._updateRequest(n)||(e.splice(t,1),t--)}e.sort(function(e,t){return e.priority-t.priority})},t._updateRequest=function(e){return e.priority=e.callback(e.handle),!(e.priority<0)||(e.resolve(!1),!1)},e}();function Ot(e,t){Object(q.a)(e),Object(q.a)(t);var n=t.rtcCenter,r=e.computedTransform,i=e._boundingVolume.center,a=new tt.a(r),s=i,o=nt.a.WGS84.cartesianToCartographic(s,new J.a),u=nt.a.WGS84.eastNorthUpToFixedFrame(s);a=new tt.a(u.invert()).multiplyRight(a),n&&a.translate(n),t.cartesianOrigin=s,t.cartographicOrigin=o,t.modelMatrix=a}n(303);var At=n(398),kt=n(332);var Nt=function(e){return void 0!==e},Ct=(new $e.a,new J.a),Lt=new J.a;new tt.a;function Pt(e,t,n){if(Q(e,"3D Tile: boundingVolume must be defined"),e.box)return function(e,t,n){var r=new J.a(e[0],e[1],e[2]),i=new $e.a(e.slice(3,e.length));if(t.transform(r,r),i=new $e.a(t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]).multiplyRight(i),Nt(n))return n.center=r,n.halfAxes=i,n;return new At.d(r,i)}(e.box,t,n);if(e.region){var r=e.region,i=r[0],a=r[1],s=r[2],o=r[3],u=r[4],c=r[5],l=new J.a(Object(we.c)((i+s)/2),Object(we.c)((o+a)/2),(u+c)/2),h=nt.a.WGS84.cartographicToCartesian(l,Lt),f=nt.a.WGS84.cartographicToCartesian([o,i,0]),d=nt.a.WGS84.cartographicToCartesian([o,s,0]),p=nt.a.WGS84.cartographicToCartesian([a,i,0]),y=8*(Math.abs(d[0]-f[0])+Math.abs(p[1]-f[1]));return Dt([h[0],h[1],h[2],y],new tt.a)}if(e.sphere)return Dt(e.sphere,t,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Dt(e,t,n){var r=new J.a(e[0],e[1],e[2]);t.transform(r,r);var i=t.getScale(Ct),a=Math.max(Math.max(i[0],i[1]),i[2]),s=e[3]*a;return Nt(n)?(n.center=r,n.radius=s,n):new At.a(r,s)}function Mt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rt=function(e){return null!=e},Bt=new Date,Ft=new J.a,jt=new At.e;var Vt=function(){function e(e,t,n,r){Q("object"==typeof t),this._tileset=e,this._header=t,this._basePath=r,this._content=null,this._contentState=F.UNLOADED,this._gpuMemoryUsageInBytes=0,this.parent=n,this.children=[],this.refine=this._getRefine(t.refine),this.cacheNode=void 0,this.userData={},"geometricError"in t?this.geometricError=t.geometricError:(this.geometricError=this.parent&&this.parent.geometricError||e.geometricError,console.warn("3D Tile: Required prop geometricError is undefined. Using parent error")),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeCache(t),this._optimChildrenWithinParent=j.NOT_COMPUTED,this._initializeRenderingState(),Object.seal(this)}var t,n,r,a=e.prototype;return a.destroy=function(){this._header=null},a.isDestroyed=function(){return null===this._header},a.getScreenSpaceError=function(e,t){var n=this._tileset,r=this.parent&&this.parent.geometricError||n.geometricError,i=t?r:this.geometricError;if(0===i)return 0;var a=Math.max(this._distanceToCamera,1e-7),s=i*e.height/(a*e.sseDenominator);return s-=this._getDynamicScreenSpaceError(a)},a._getDynamicScreenSpaceError=function(e){var t=this._tileset;if(t.dynamicScreenSpaceError&&t._dynamicScreenSpaceErrorComputedDensity){var n=t._dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return function(e,t){var n=e*t;return 1-Math.exp(-n*n)}(e,n)*r}return 0},a.loadContent=function(){var e,t=(e=i.a.mark(function e(t){var n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(e){return e._visible?e._contentState===F.UNLOADED?-1:e._priority||0:-1},!this.hasEmptyContent){e.next=3;break}return e.abrupt("return",!1);case 3:if(!this._content){e.next=5;break}return e.abrupt("return",!0);case 5:return this.contentExpired&&(this.expireDate=void 0),this._contentState=F.LOADING,e.next=10,this.tileset._requestScheduler.scheduleRequest(this,n);case 10:if(e.sent){e.next=15;break}return console.log("Tile load cancelled"),this._contentState=F.UNLOADED,e.abrupt("return",!1);case 15:return e.prev=15,r=this.uri,e.prev=17,this.tileset._requestScheduler.startRequest(this),e.next=21,Object(kt.a)(r,this.tileset.options.fetchOptions);case 21:a=e.sent;case 22:return e.prev=22,this.tileset._requestScheduler.endRequest(this),e.finish(22);case 25:return e.next=27,Object(R.a)(a,[mt,vt],{DracoLoader:t});case 27:return this._content=e.sent,-1!==r.indexOf(".json")&&this._tileset._initializeTileHeaders(this._content,this.parent,gt.b.dirname(this.uri)),this._contentState=F.READY,this._contentLoaded(),e.abrupt("return",!0);case 34:throw e.prev=34,e.t0=e.catch(15),this._contentState=F.FAILED,e.t0;case 38:case"end":return e.stop()}},e,this,[[15,34],[17,,22,25]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Mt(a,r,i,s,o,"next",e)}function o(e){Mt(a,r,i,s,o,"throw",e)}s(void 0)})});return function(e){return t.apply(this,arguments)}}(),a.unloadContent=function(){return!!this.hasRenderContent&&(this._content&&this._content.destroy&&this._content.destroy(),this._content=null,this._contentState=F.UNLOADED,!0)},a.updateVisibility=function(e){var t=this._tileset;if(this._updatedVisibilityFrame!==t._updatedVisibilityFrame){var n=this.parent,r=n?n.computedTransform:this._tileset.modelMatrix,i=n?n._visibilityPlaneMask:At.b.MASK_INDETERMINATE;this._updateTransform(r),this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==At.b.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._updatedVisibilityFrame=t._updatedVisibilityFrame}},a.updateExpiration=function(){if(Rt(this.expireDate)&&this.contentReady&&!this.hasEmptyContent){var e=Date.now(Bt);Date.lessThan(this.expireDate,e)&&(this._contentState=F.EXPIRED,this._expiredContent=this._content)}},a.visibility=function(e,t){var n=e.cullingVolume,r=this.boundingVolume,i=this.tileset,a=i.clippingPlanes,s=i.clippingPlanesOriginMatrix;if(a&&a.enabled){var o=a.computeIntersectionWithBoundingVolume(r,s);if(this._isClipped=o!==At.c.INSIDE,o===At.c.OUTSIDE)return At.b.MASK_OUTSIDE}return function(e,t,n){if(Q(t,"boundingVolume is required."),Q(Number.isFinite(n),"parentPlaneMask is required."),n===At.b.MASK_OUTSIDE||n===At.b.MASK_INSIDE)return n;for(var r=At.b.MASK_INSIDE,i=e.planes,a=0;a<e.planes.length;++a){var s=a<31?1<<a:0;if(!(a<31&&0==(n&s))){var o=jt.fromNormalDistance(i[a].normal,i[a].distance),u=t.intersectPlane(o);if(u===At.c.OUTSIDE)return At.b.MASK_OUTSIDE;u===At.c.INTERSECTING&&(r|=s)}}return r}(n,r,t)},a.contentVisibility=function(e){return!0},a.distanceToTile=function(e){var t=this._boundingVolume;return Math.sqrt(t.distanceSquaredTo(e.camera.position))},a.cameraSpaceZDepth=function(e){var t=e.camera,n=this.boundingVolume;return Ft.subVectors(n.center,t.position),t.direction.dot(Ft)},a.insideViewerRequestVolume=function(e){var t=this._viewerRequestVolume;return!t||0===t.distanceToCamera(e)},a._initializeCache=function(e){this.cacheNode=void 0;var t,n,r=e.expire;r&&(t=r.duration,r.date&&(n=Date.fromIso8601(r.date))),this.expireDuration=t,this.expireDate=n},a._initializeTransforms=function(e){this.transform=e.transform?new tt.a(e.transform):new tt.a;var t=this.parent,n=this._tileset,r=t&&t.computedTransform?t.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new tt.a(r).multiplyRight(this.transform);var i=t&&t._initialTransform?t._initialTransform.clone():new tt.a;this._initialTransform=new tt.a(i).multiplyRight(this.transform)},a._initializeBoundingVolumes=function(e){this._boundingVolume=Pt(e.boundingVolume,this.computedTransform),this._contentBoundingVolume=null,this._viewerRequestVolume=null,e.content&&e.content.boundingVolume&&(this._contentBoundingVolume=Pt(e.boundingVolume,this.computedTransform)),e.viewerRequestVolume&&(this._viewerRequestVolume=Pt(e.viewerRequestVolume,this.computedTransform))},a._initializeContent=function(e){this._content={_tileset:this._tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=F.UNLOADED,this._expiredContent=void 0,this._serverKey=null,this.hasTilesetContent=!1,e.content&&(this.contentUri=e.content.uri||e.content.url,"url"in e&&(console.warn('Tileset 3D: "content.url" property deprecated. Use "content.uri" instead.'),this.contentUri=e.url),this._content=null,this.hasEmptyContent=!1,this.contentState=F.UNLOADED)},a._initializeRenderingState=function(){this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=At.b.MASK_INDETERMINATE,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._priority=0},a._getRefine=function(e){switch(e){case"REPLACE":case"replace":return G;case"ADD":case"add":return V;default:return this.parent?this.parent.refine:G}},a._isTileset=function(e){return Boolean(e.asset)},a._contentLoaded=function(){switch(this._content&&this._content.type){case"vctr":case"geom":tileset.traverser.disableSkipLevelOfDetail=!0}this._isTileset(this._content)&&(this.hasTilesetContent=!0)},a._updateTransform=function(e){void 0===e&&(e=new tt.a);var t=e.clone().multiplyRight(this.transform);if(!t.equals(this.computedTransform)){this.computedTransform=t;var n=this._header,r=this._header.content;this._boundingVolume=Pt(n.boundingVolume,this.computedTransform,this._boundingVolume),this._contentBoundingVolume&&(this._contentBoundingVolume=Pt(r.boundingVolume,this.computedTransform,this._contentBoundingVolume)),this._viewerRequestVolume&&(this._viewerRequestVolume=Pt(n.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume))}},t=e,(n=[{key:"gpuMemoryUsageInBytes",get:function(){return this._gpuMemoryUsageInBytes}},{key:"tileset",get:function(){return this._tileset}},{key:"depth",get:function(){return this._depth}},{key:"selectedFrame",get:function(){return this._selectedFrame}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"content",get:function(){return this._content}},{key:"contentReady",get:function(){return this._contentState===F.READY}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"contentAvailable",get:function(){return this.contentReady&&this.hasRenderContent||Rt(this._expiredContent)&&!this.contentFailed}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this._contentState===F.UNLOADED}},{key:"contentExpired",get:function(){return this._contentState===F.EXPIRED}},{key:"contentFailed",get:function(){return this._contentState===F.FAILED}},{key:"url",get:function(){return this.tileset.getTileUrl(this.contentUri,this._basePath)}},{key:"uri",get:function(){return this.tileset.getTileUrl(this.contentUri,this._basePath)}},{key:"boundingVolume",get:function(){return this._boundingVolume}},{key:"contentBoundingVolume",get:function(){return this._contentBoundingVolume||this._boundingVolume}},{key:"boundingSphere",get:function(){return this._boundingVolume.boundingSphere}},{key:"extras",get:function(){return this._header.extras}}])&&Ut(t.prototype,n),r&&Ut(t,r),e}();function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qt=function(){function e(e){void 0===e&&(e=0),this._array=new Array(e),this._length=e}var t,n,r,i=e.prototype;return i.get=function(e){return Q(e<this._array.length),this._array[e]},i.set=function(e,t){Q(e>=0),e>=this.length&&(this.length=e+1),this._array[e]=t},i.peek=function(){return this._array[this._length-1]},i.push=function(e){var t=this.length++;this._array[t]=e},i.pop=function(){return this._array[--this.length]},i.reserve=function(e){Q(e>=0),e>this._array.length&&(this._array.length=e)},i.resize=function(e){Q(e>=0),this.length=e},i.trim=function(e){void 0===e&&(e=this.length),this._array.length=e},t=e,(n=[{key:"length",get:function(){return this._length},set:function(e){this._length=e,e>this._array.length&&(this._array.length=e)}},{key:"values",get:function(){return this._array}}])&&Gt(t.prototype,n),r&&Gt(t,r),e}(),zt=function(){function e(){this.traversal={stack:new qt,stackMaximumLength:0},this.emptyTraversal={stack:new qt,stackMaximumLength:0},this.result={_requestedTiles:[],selectedTiles:[],_emptyTiles:[],_hasMixedContent:!1},this._disableSkipLevelOfDetail=!1}var t=e.prototype;return t.traverse=function(e,t,n){if(this.root=e,this.options=n,this.result._requestedTiles.length=0,this.result.selectedTiles.length=0,this.result._emptyTiles.length=0,this.result._hasMixedContent=!1,this.updateTile(e,t),!e.isVisibleAndInRequestVolume)return!1;if(e.getScreenSpaceError(t,!0)<=n.maximumScreenSpaceError)return!1;var r=n.maximumScreenSpaceError;return this.executeTraversal(e,r,t),this.traversal.stack.trim(this.traversal.stackMaximumLength),this.emptyTraversal.stack.trim(this.emptyTraversal.stackMaximumLength),!0},t.selectTile=function(e,t){e._selectedFrame=t.frameNumber,this.result.selectedTiles.push(e)},t.selectDesiredTile=function(e,t){if(this.options.skipLevelOfDetail){var n=e.contentAvailable?e:e._ancestorWithContentAvailable;n?n._shouldSelect=!0:this.selectDescendants(e,t)}else e.contentAvailable&&this.selectTile(e,t)},t.visitTile=function(e,t,n){++e._statistics.visited,t._visitedFrame=n.frameNumber},t.touchTile=function(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber},t.getPriority=function(e,t){switch(e.refine){case V:return e._distanceToCamera;case G:var n=e.parent,r=n&&(!t.skipLevelOfDetail||0===e._screenSpaceError||n.hasTilesetContent)?n._screenSpaceError:e._screenSpaceError;return this.root._screenSpaceError-r;default:return Q(!1)}},t.loadTile=function(e,t){(e.hasUnloadedContent||e.contentExpired)&&(e._requestedFrame=t.frameNumber,e._priority=this.getPriority(e,this.options),this.result._requestedTiles.push(e))},t.updateTileVisibility=function(e,t){e.updateVisibility(t)},t.updateTile=function(e,t){this.updateTileVisibility(e,t),e.updateExpiration()},t.updateAndPushChildren=function(e,t,n){var r=e.children,i=Array.isArray(r),a=0;for(r=i?r:r[Symbol.iterator]();;){var s;if(i){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var o=s;this.updateTile(o,n),t.push(o)}return!0},t.canTraverse=function(e,t){return!(0===e.children.length||t.depthLimit<e.depth)&&(e.hasTilesetContent?!e.contentExpired:e._screenSpaceError>t.maximumScreenSpaceError)},t.executeTraversal=function(e,t,n){var r=this.traversal,i=r.stack;for(i.push(e);i.length>0;){r.stackMaximumLength=Math.max(r.stackMaximumLength,i.length);var a=i.pop(),s=a.refine===V,o=a.refine===G,u=a.parent,c=!u||u._refines,l=!1;this.canTraverse(a,this.options)&&(l=this.updateAndPushChildren(a,i,n)&&c);var h=!l&&c;a.hasRenderContent?s?(this.loadTile(a,n),this.selectDesiredTile(a,n)):o&&(this.loadTile(a,n),h&&this.selectDesiredTile(a,n)):(this.result._emptyTiles.push(a),this.loadTile(a,n),h&&this.selectDesiredTile(a,n)),this.touchTile(a,n),a._refines=l}},e}(),Ht=function(e,t,n){this.item=e,this.previous=t,this.next=n};function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wt=function(e){return void 0!==e},Yt=function(){function e(){this.head=void 0,this.tail=void 0,this._length=0}var t,n,r,i=e.prototype;return i.add=function(e){var t=new Ht(e,this.tail,void 0);return Wt(this.tail)?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t},i.remove=function(e){Wt(e)&&(Wt(e.previous)&&Wt(e.next)?(e.previous.next=e.next,e.next.previous=e.previous):Wt(e.previous)?(e.previous.next=void 0,this.tail=e.previous):Wt(e.next)?(e.next.previous=void 0,this.head=e.next):(this.head=void 0,this.tail=void 0),e.next=void 0,e.previous=void 0,--this._length)},i.splice=function(e,t){if(e!==t){this.remove(t);var n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e}},t=e,(n=[{key:"length",get:function(){return this._length}}])&&Jt(t.prototype,n),r&&Jt(t,r),e}(),Qt=function(e){return void 0!==e},Zt=function(){function e(){this._list=new Yt,this._sentinel=this._list.add(),this._trimTiles=!1}var t=e.prototype;return t.reset=function(){this._list.splice(this._list.tail,this._sentinel)},t.touch=function(e){var t=e.cacheNode;Qt(t)&&this._list.splice(this._sentinel,t)},t.add=function(e,t,n){Qt(t.cacheNode)||(t.cacheNode=this._list.add(t),n&&n(e,t))},t.unloadTile=function(e,t,n){var r=t.cacheNode;Qt(r)&&(this._list.remove(r),t.cacheNode=void 0,n&&n(e,t))},t.unloadTiles=function(e,t){var n=this._trimTiles;this._trimTiles=!1;for(var r=this._list,i=1024*e.maximumMemoryUsage*1024,a=this._sentinel,s=r.head;s!==a&&(e.gpuMemoryUsageInBytes>i||n);){var o=s.item;s=s.next,this.unloadTile(e,o,t)}},t.trim=function(){this._trimTiles=!0},e}();function Kt(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function Xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $t=6378137,en=6378137,tn=6356752.314245179;var nn={basePath:"",ellipsoid:nt.a.WGS84,modelMatrix:new tt.a,throttleRequests:!1,cullWithChildrenBounds:!0,maximumScreenSpaceError:16,maximumMemoryUsage:32,dynamicScreenSpaceError:!1,dynamicScreenSpaceErrorDensity:.00278,dynamicScreenSpaceErrorFactor:4,dynamicScreenSpaceErrorHeightFalloff:.25,skipLevelOfDetail:!1,baseScreenSpaceError:1024,skipScreenSpaceErrorFactor:16,skipLevels:1,immediatelyLoadDesiredLevelOfDetail:!1,loadSiblings:!1,onTileLoad:function(){},onTileUnload:function(){},onTileLoadFail:function(e,t,n){return console.error("A 3D tile failed to load: "+n+" "+t)}};var rn=function(){function e(e,t,n){void 0===n&&(n={}),Q(e),this.options=Object.assign({},nn,{},n),this.url=t,this.basePath=gt.b.dirname(t),this.modelMatrix=this.options.modelMatrix,this.stats=new _t.a({id:t}),this._initializeStats(),this.gpuMemoryUsageInBytes=0,this.geometricError=void 0,this.userData={},this._queryParams={},this._requestScheduler=new St({throttleRequests:this.options.throttleRequests}),this._traverser=new zt,this._cache=new Zt,this._processingQueue=[],this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._root=void 0,this._asset=void 0,this._properties=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._extras=void 0,this._credits=void 0,this._allTilesAdditive=!0,this._hasMixedContent=!1,this._maximumScreenSpaceError=n.maximumScreenSpaceError,this._maximumMemoryUsage=n.maximumMemoryUsage,this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._readyPromise=Promise.resolve(),this._classificationType=this.options.classificationType,this._ellipsoid=this.options.ellipsoid,this._dynamicScreenSpaceErrorComputedDensity=0,this._initializeTileSet(e,this.options)}var t,n,r,a=e.prototype;return a.destroy=function(){this._destroy()},a.getTileUrl=function(e,t){return e.startsWith("data:")?e:(t||this.basePath)+"/"+e+this.queryParams},a.hasExtension=function(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)},a.update=function(e){this._updatedVisibilityFrame++,this._cache.reset(),this._traverser.traverse(this.root,e,this.options),Object.assign(this,this._traverser.result);var t=this._requestedTiles,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var a=i;this._loadTile(a)}this._unloadTiles();var s=0,o=0,u=this.selectedTiles,c=Array.isArray(u),l=0;for(u=c?u:u[Symbol.iterator]();;){var h;if(c){if(l>=u.length)break;h=u[l++]}else{if((l=u.next()).done)break;h=l.value}var f=h;f.contentAvailable&&(s++,f.content.pointCount&&(o+=f.content.pointCount))}this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=s,this.stats.get("Points").count=o},a.trimLoadedTiles=function(){this._cache.trim()},a.addTileToCache=function(e){this._cache.add(this,e,function(e,t){return e._addTileToCache(t)})},a._initializeTileSet=function(e,t){var n=e.asset;if(!n)throw new Error("Tileset must have an asset property.");if("0.0"!==n.version&&"1.0"!==n.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in n&&(this._queryParams.v=n.tilesetVersion),this._asset=e.asset,this._properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this._extras=e.extras,this._credits={},this._root=this._initializeTileHeaders(e,null),this._calculateViewProps()},a._calculateViewProps=function(){var e=this._root,t=e.boundingVolume.center;if(!t)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new J.a,void(this.zoom=16);this.cartographicCenter=nt.a.WGS84.cartesianToCartographic(t,new J.a),this.zoom=function(e){var t=e.halfAxes,n=e.radius,r=e.width,i=e.height;if(t){var a=t[0],s=t[4],o=t[8];return(Math.log2($t/a/2)+Math.log2(en/s/2)+Math.log2(tn/o/2))/3}return n?Math.log2(tn/n):i&&r?(Math.log2($t/r)+Math.log2(en/i))/2:18}(e.boundingVolume)},a._initializeStats=function(){this.stats.get("Tiles In Tileset(s)"),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points","memory"),this.stats.get("Tile Memory Use","memory")},a._initializeTileHeaders=function(e,t,n){var r=new Vt(this,e.root,t,n);t&&(t.children.push(r),r._depth=t._depth+1);var i=[];for(i.push(r);i.length>0;){var a=i.pop();this.stats.get("Tiles In Tileset(s)").incrementCount();var s=a._header.children||[],o=Array.isArray(s),u=0;for(s=o?s:s[Symbol.iterator]();;){var c;if(o){if(u>=s.length)break;c=s[u++]}else{if((u=s.next()).done)break;c=u.value}var l=new Vt(this,c,a,n);a.children.push(l),l._depth=a._depth+1,i.push(l)}}return r},a._destroyTileHeaders=function(e){this._destroySubtree(e)},a._loadTile=function(){var e,t=(e=i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.stats.get("Tiles Loading").incrementCount(),e.prev=1,e.next=4,t.loadContent(this.options.DracoLoader);case 4:n=e.sent,e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(1),this.stats.get("Tiles Loading").decrementCount(),this.stats.get("Failed Tile Loads").incrementCount(),this.options.onTileLoadFail(t,e.t0.message||e.t0.toString(),t.url),e.abrupt("return");case 13:if(this.stats.get("Tiles Loading").decrementCount(),n){e.next=16;break}return e.abrupt("return");case 16:t&&t._content&&Ot(t,t._content),this.options.onTileLoad(t);case 18:case"end":return e.stop()}},e,this,[[1,7]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Kt(a,r,i,s,o,"next",e)}function o(e){Kt(a,r,i,s,o,"throw",e)}s(void 0)})});return function(e){return t.apply(this,arguments)}}(),a._addTileToCache=function(e){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=e._content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes},a._unloadTile=function(e){this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.gpuMemoryUsageInBytes-=e._content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()},a._unloadTiles=function(){this._cache.unloadTiles(this,function(e,t){return e._unloadTile(t)})},a._destroy=function(){var e=[];for(this._root&&e.push(this._root);e.length>0;){var t=s.children,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var a=i;e.push(a)}var s=e.pop();s.destroy()}this._root=null},a._destroySubtree=function(e){var t=e,n=[];for(n.push(t);n.length>0;){var r=(e=n.pop()).children,i=Array.isArray(r),a=0;for(r=i?r:r[Symbol.iterator]();;){var s;if(i){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var o=s;n.push(o)}e!==t&&this._destroyTile(e)}t.children=[]},a._destroyTile=function(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()},t=e,(n=[{key:"asset",get:function(){return this._asset}},{key:"properties",get:function(){return this._properties}},{key:"ready",get:function(){return Boolean(this._root)}},{key:"readyPromise",get:function(){return this._readyPromise.promise}},{key:"tilesLoaded",get:function(){return this._tilesLoaded}},{key:"queryParams",get:function(){return function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.push(i+"="+e[i])}switch(t.length){case 0:return"";case 1:return"?"+t[0];default:return"?"+t.join("&")}}(this._queryParams)}},{key:"root",get:function(){return this._root}},{key:"boundingSphere",get:function(){return this._checkReady(),this._root.updateTransform(this.modelMatrix),this._root.boundingSphere}},{key:"timeSinceLoad",get:function(){return this._timeSinceLoad}},{key:"maximumMemoryUsage",get:function(){return this._maximumMemoryUsage},set:function(e){Q(e>0),this._maximumMemoryUsage=e}},{key:"ellipsoid",get:function(){return this.options.ellipsoid}},{key:"extras",get:function(){return this._extras}}])&&Xt(t.prototype,n),r&&Xt(t,r),e}(),an=n(365);function sn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function on(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){sn(a,r,i,s,o,"next",e)}function o(e){sn(a,r,i,s,o,"throw",e)}s(void 0)})}}var un="https://api.cesium.com/v1/assets";function cn(e,t){return ln.apply(this,arguments)}function ln(){return(ln=on(i.a.mark(function e(t,n){var r,a,s,o,u,c,l,h,f;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=19;break}return e.next=3,hn(t);case 3:r=e.sent,a=r.items,s=Array.isArray(a),o=0,a=s?a:a[Symbol.iterator]();case 5:if(!s){e.next=11;break}if(!(o>=a.length)){e.next=8;break}return e.abrupt("break",19);case 8:u=a[o++],e.next=15;break;case 11:if(!(o=a.next()).done){e.next=14;break}return e.abrupt("break",19);case 14:u=o.value;case 15:"3DTILES"===(c=u).type&&(n=c.id);case 17:e.next=5;break;case 19:return e.next=21,dn(t,n);case 21:return l=e.sent,h=l.type,f=l.url,Q("3DTILES"===h&&f),l.headers={Authorization:"Bearer "+l.accessToken},e.abrupt("return",l);case 26:case"end":return e.stop()}},e)}))).apply(this,arguments)}function hn(e){return fn.apply(this,arguments)}function fn(){return(fn=on(i.a.mark(function e(t){var n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Q(t),n=un,r={Authorization:"Bearer "+t},e.next=5,fetch(n,{headers:r});case 5:if((a=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,Object(an.a)(a);case 10:throw e.t1=e.sent,new e.t0(e.t1);case 12:return e.next=14,a.json();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function dn(e,t){return pn.apply(this,arguments)}function pn(){return(pn=on(i.a.mark(function e(t,n){var r,a,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Q(t,n),r=un+"/"+n+"/endpoint",a={Authorization:"Bearer "+t},e.next=5,fetch(r,{headers:a});case 5:if((s=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,Object(an.a)(s);case 10:throw e.t1=e.sent,new e.t0(e.t1);case 12:return e.next=14,s.json();case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}var yn=n(617),mn=n(424),vn=n(466),_n=new At.e,gn=new J.a,bn=new At.b([new At.e,new At.e,new At.e,new At.e,new At.e,new At.e]);function Tn(e,t){var n=t.height,r=t.tick,i=e.cameraDirection,a=e.cameraUp,s=e.distanceScales.metersPerPixel,o=[e.longitude,e.latitude,0],u=nt.a.WGS84.cartographicToCartesian(o,new J.a),c=nt.a.WGS84.eastNorthUpToFixedFrame(u),l=e.unprojectPosition(e.cameraPosition),h=nt.a.WGS84.cartographicToCartesian(l,new J.a),f=new J.a(c.transformAsVector(new J.a(i).scale(s))).normalize(),d=new J.a(c.transformAsVector(new J.a(a).scale(s))).normalize();return function(e){var t=[e.longitude,e.latitude,0],n=nt.a.WGS84.cartographicToCartesian(t,new J.a),r=e.getFrustumPlanes(),i=0;for(var a in r){var s=r[a],o=s.normal.dot(e.center),u=s.normal.len();gn.copy(s.normal).scale((s.distance-o)/(u*u)).add(e.center);var c=e.unprojectPosition(gn),l=nt.a.WGS84.cartographicToCartesian(c,new J.a);_n.normal.copy(l).subtract(n).scale(-1).normalize(),_n.distance=Math.abs(_n.normal.dot(l)),bn.planes[i].normal.copy(_n.normal),bn.planes[i].distance=_n.distance,i+=1}}(e),{camera:{position:h,direction:f,up:d},height:n,cullingVolume:bn,frameNumber:r,sseDenominator:1.15}}function wn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function xn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){wn(a,r,i,s,o,"next",e)}function o(e){wn(a,r,i,s,o,"throw",e)}s(void 0)})}}Object(U.b)([mt,vt,yn.a]);var In={tilesetUrl:null,ionAssetId:null,ionAccessToken:null,color:[155,155,155,200],depthLimit:Number.MAX_SAFE_INTEGER,onTilesetLoad:function(){},onTileLoad:function(){}},En=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.initializeState=function(){this.state={layerMap:{},layers:[],tileset3d:null}},a.shouldUpdateState=function(e){return e.changeFlags.somethingChanged},a.updateState=function(){var e=xn(i.a.mark(function e(t){var n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,r=t.oldProps,!n.tilesetUrl||n.tilesetUrl===r.tilesetUrl){e.next=6;break}return e.next=4,this._loadTileset(n.tilesetUrl);case 4:e.next=9;break;case 6:if(!n.ionAccessToken&&!n.ionAssetId||n.ionAccessToken===r.ionAccessToken&&n.ionAssetId===r.ionAssetId){e.next=9;break}return e.next=9,this._loadTilesetFromIon(n.ionAccessToken,n.ionAssetId);case 9:a=this.state.tileset3d,this._updateTileset(a);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._loadTileset=function(){var e=xn(i.a.mark(function e(t,n,r){var a,s,o,u=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,!t){e.next=9;break}return e.next=4,fetch(t,n);case 4:return s=e.sent,e.next=7,s.json();case 7:o=e.sent,a=new rn(o,t,Object.assign({throttleRequests:!0,onTileLoad:function(e){u.props.onTileLoad(e),u._updateTileset(a)},DracoLoader:mn.a,fetchOptions:n},r));case 9:this.setState({tileset3d:a,layerMap:{},layers:[]}),a&&(a.depthLimit=this.props.depthLimit,this.props.onTilesetLoad(a));case 11:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}(),a._loadTilesetFromIon=function(){var e=xn(i.a.mark(function e(t,n){var r,a,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cn(t,n);case 2:return r=e.sent,a=r.url,s=r.headers,e.next=6,this._loadTileset(a,{headers:s},r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),a._updateTileset=function(e){var t=this.context,n=t.animationProps,r=t.viewport;if(n&&r&&e){var i=Tn(r,n);e.update(i,mn.a),this._updateLayers(),this._selectLayers(i)}},a._selectLayers=function(e){for(var t=this.state.layerMap,n=e.frameNumber,r=[],i=0,a=Object.values(t);i<a.length;i++){var s=a[i],o=s.tile,u=s.layer;o.selectedFrame===n?(u&&u.props&&!u.props.visible&&(u=u.clone({visible:!0}),t[o.contentUri].layer=u),r.push(u)):o.contentUnloaded?delete t[o.contentUri]:u&&u.props&&u.props.visible&&(u=u.clone({visible:!1}),t[o.contentUri].layer=u)}this.setState({layers:r})},a._updateLayers=function(){var e=this.state,t=e.tileset3d,n=e.layerMap,r=t.selectedTiles.filter(function(e){return!n[e.contentUri]}),i=Array.isArray(r),a=0;for(r=i?r:r[Symbol.iterator]();;){var s;if(i){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var o=s;this._unpackTile(o);var u=this._create3DTileLayer(o);t.addTileToCache(o),n[o.contentUri]={layer:u,tile:o}}},a._unpackTile=function(e){var t=e.content;if(t)switch(t.type){case"pnts":break;case"i3dm":case"b3dm":this._unpackGLTF(e);break;default:throw new Error("Tile3DLayer: Error unpacking 3D tile "+t.type)}},a._unpackGLTF=function(e){e.content.gltfArrayBuffer&&(e.userData.gltf=Object(R.a)(e.content.gltfArrayBuffer,{DracoLoader:vn.a,decompress:!0})),e.content.gltfUrl&&(e.userData.gltf=e.tileset.getTileUrl(e.content.gltfUrl))},a._create3DTileLayer=function(e){if(!e.content)return null;switch(e.content.type){case"pnts":return this._createPointCloudTileLayer(e);case"i3dm":case"b3dm":return this._create3DModelTileLayer(e);default:throw new Error("Tile3DLayer: Failed to render layer of type "+e.content.type)}},a._create3DModelTileLayer=function(e){var t=e.userData.gltf,n=e.content,r=n.instances,i=n.cartographicOrigin,a=n.modelMatrix;return new M.a({id:"3d-model-tile-layer-"+e.contentUri,data:r||[{}],coordinateSystem:L.a.METER_OFFSETS,coordinateOrigin:i,pickable:!0,scenegraph:t,sizeScale:1,getTransformMatrix:function(e){return e.modelMatrix?a.clone().multiplyRight(e.modelMatrix):a},getPosition:function(e){return[0,0,0]},getColor:function(e){return[255,255,255,100]},opacity:1,_lighting:"pbr"})},a._createPointCloudTileLayer=function(e){var t=e.content,n=t.attributes,r=t.pointCount,i=t.constantRGBA,a=t.cartographicOrigin,s=t.modelMatrix,o=n.positions,u=n.normals,c=n.colors;return o&&new D.a({id:"3d-point-cloud-tile-layer-"+e.contentUri,data:{header:{vertexCount:r},attributes:{POSITION:o,NORMAL:u,COLOR_0:c}},coordinateSystem:L.a.METER_OFFSETS,coordinateOrigin:a,modelMatrix:s,getColor:i||this.props.color,pickable:!0,numInstances:r,opacity:1,pointSize:1})},a.renderLayers=function(){return this.state.layers},r}(P.a);En.layerName="Tile3DLayer",En.defaultProps=In;n(27);var Sn=n(447);var On=Sn.a.div.withConfig({displayName:"control-panel__Container",componentId:"sc-14q5t5u-0"})(["display:flex;flex-direction:column;position:absolute;top:0;right:0;max-width:320px;background:#fff;box-shadow:0 2px 4px rgba(0,0,0,0.3);padding:12px 24px;margin:20px;font-size:13px;line-height:2;outline:none;z-index:100;"]),An=Sn.a.select.withConfig({displayName:"control-panel__DropDown",componentId:"sc-14q5t5u-1"})(["margin-bottom:12px;"]),kn=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i._renderByCategories=function(){var e=this.props,t=e.category,n=e.name,r=e.onExampleChange,i=e.data,a=Object.keys(i),o=t+"."+n;return s.a.createElement(An,{value:o,onChange:function(e){var t=e.target.value.split(".");r({category:t[0],name:t[1]})}},a.map(function(e,t){var n=i[e].examples;return s.a.createElement("optgroup",{key:t,label:e},Object.keys(n).map(function(t,n){var r=e+"."+t;return s.a.createElement("option",{key:n,value:r},t)}))}))},i._renderMapStyles=function(){var e=this.props,t=e.onMapStyleChange,n=e.mapStyles,r=e.selectedMapStyle;return s.a.createElement(An,{value:r,onChange:function(e){var n=e.target.value;t({selectedMapStyle:n})}},Object.keys(n).map(function(e){return s.a.createElement("option",{key:e,value:n[e]},e)}))},i._renderDropped=function(){var e=this.props.droppedFile;return e?s.a.createElement("div",null,"Dropped file: ",JSON.stringify(e.name)):null},i.render=function(){return s.a.createElement(On,null,this._renderMapStyles(),this._renderByCategories(),this._renderDropped(),this.props.children)},r}(a.PureComponent);function Nn(e,t){e.ondragover=function(e){e.dataTransfer.dropEffect="link",e.preventDefault()},e.ondrop=function(e){e.preventDefault(),e.dataTransfer.files&&1===e.dataTransfer.files.length&&t(e.dataTransfer.files[0])}}function Cn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}kn.defaultProps={droppedFile:null,onChange:function(){}};var Ln="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlNGZmZjBjMS04ZGYwLTRhYjAtOWIzYy0wZWJmNzI4OWZhNGEiLCJpZCI6MTYyMywic2NvcGVzIjpbImFzciIsImdjIl0sImFzc2V0cyI6WzI5MzI4LDI5MzMxLDI5MzMyLDI5MzMzLDI5MzM0LDI5MzM1LDEsMiwzLDQsMzk1NF0sImlhdCI6MTU2MDQ0ODA2Nn0.zZPuc5WzTsrKNviCY2jyhmDwJITXzhbRTnJS025_uBw",Pn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxN2NhMzkwYi0zNWM4LTRjNTYtYWE3Mi1jMDAxYzhlOGVmNTAiLCJpZCI6OTYxOSwic2NvcGVzIjpbImFzbCIsImFzciIsImFzdyIsImdjIl0sImlhdCI6MTU2MjE4MTMxM30.OkgVr6NaKYxabUMIGqPOYFe0V5JifXLVLfpae63x-tA",Dn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIzMGY4ODczYy1mNTk4LTRiMDUtYmIxYy0xZWYwOWZmMGY4NjQiLCJpZCI6NDQsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJhc3NldHMiOlsxLDIsMyw0LDYxOTMsNjI3Myw3MTYyLDczNTMsNzE0Ml0sImlhdCI6MTU0MTYxODM0NX0.lWnGs9ySXO4QK3HagcMsDpZ8L01DpmUDQm38-2QAQuE",Mn="https://raw.githubusercontent.com/uber-web/loaders.gl/master",Un=Mn+"/modules/3d-tiles/test/data/index.json",Rn={additional:{name:"additional",examples:{"Mount St Helens (Cesium Ion PointCloud)":{ionAssetId:33301,ionAccessToken:Pn},"Montreal (Cesium Ion PointCloud)":{ionAssetId:28945,ionAccessToken:Pn},"New York Buildings 1 (Cesium Ion 3D Batched)":{ionAssetId:6193,ionAccessToken:Dn},"New York Buildings 2 (Cesium Ion 3D Batched)":{ionAssetId:7162,ionAccessToken:Dn},"Royal Exhibition Building (Github Pages)":{tilesetUrl:"https://raw.githubusercontent.com/uber-common/deck.gl-data/master/3d-tiles/RoyalExhibitionBuilding/tileset.json"}}},vricon:{name:"vricon",examples:{Cairo:{ionAssetId:29328,ionAccessToken:Ln},Caracas:{ionAssetId:29331,ionAccessToken:Ln},Damascus:{ionAssetId:29332,ionAccessToken:Ln},Honolulu:{ionAssetId:29333,ionAccessToken:Ln},"San Francisco":{ionAssetId:29334,ionAccessToken:Ln},Tehran:{ionAssetId:29335,ionAccessToken:Ln}}}};function Bn(){return Fn.apply(this,arguments)}function Fn(){var e;return e=i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(Un);case 2:return t=e.sent,e.next=5,t.json();case 5:return delete(n=e.sent).Geometry,delete n.Vector,delete n.Composite,e.abrupt("return",Object.assign({},n,{},Rn,{custom:{name:"Custom",examples:{"Custom Tileset":{},"ION Tileset":{}}}}));case 10:case"end":return e.stop()}},e)}),(Fn=function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){Cn(a,r,i,s,o,"next",e)}function o(e){Cn(a,r,i,s,o,"throw",e)}s(void 0)})}).apply(this,arguments)}function jn(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function Vn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){jn(a,r,i,s,o,"next",e)}function o(e){jn(a,r,i,s,o,"throw",e)}s(void 0)})}}function Gn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"INITIAL_EXAMPLE_CATEGORY",function(){return qn}),n.d(t,"INITIAL_EXAMPLE_NAME",function(){return zn}),n.d(t,"INITIAL_VIEW_STATE",function(){return Wn}),n.d(t,"default",function(){return Yn}),n.d(t,"renderToDOM",function(){return Qn});var qn="additional",zn="Mount St Helens (Cesium Ion PointCloud)",Hn={"Satellite Base Map":"mapbox://styles/mapbox/satellite-v9","Light Base Map":"mapbox://styles/mapbox/light-v9","Dark Base Map":"mapbox://styles/mapbox/dark-v9"},Jn=Hn["Dark Base Map"],Wn=Object.assign({},{latitude:40.04248558075302,longitude:-75.61213987669433},{pitch:45,maxPitch:60,bearing:0,minZoom:2,maxZoom:30,zoom:17}),Yn=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).state={viewState:Wn,featureTable:null,batchTable:null,droppedFile:null,examplesByCategory:null,tilesetExampleProps:{},category:qn,name:zn,selectedMapStyle:Jn},n._deckRef=null,n._onTilesetLoad=n._onTilesetLoad.bind(Gn(n)),n._onTilesetChange=n._onTilesetChange.bind(Gn(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.componentDidMount=function(){var e=Vn(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._statsWidgetContainer,this._memWidget=new d.a(f.a.get("Memory Usage"),{framesPerUpdate:1,formatters:{"GPU Memory":"memory","Buffer Memory":"memory","Renderbuffer Memory":"memory","Texture Memory":"memory"},container:t}),this._tilesetStatsWidget=new d.a(null,{container:t}),Nn(this._deckRef.deckCanvas,function(e,t){alert("File drop of tilesets not yet implemented")}),e.next=6,this._loadExampleIndex();case 6:return e.next=8,this._loadInitialTileset();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),a._loadExampleIndex=function(){var e=Vn(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bn();case 2:t=e.sent,this.setState({examplesByCategory:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),a._loadInitialTileset=function(){var e=Vn(i.a.mark(function e(){var t,n,r,a,s,o,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URL(window.location.href),n=t.searchParams.get("ionAccessToken"),r=t.searchParams.get("ionAssetId"),!n||!r){e.next=7;break}return e.next=6,this._loadTilesetFromIonAsset(n,r);case 6:return e.abrupt("return");case 7:if(!(a=t.searchParams.get("tileset"))){e.next=12;break}return e.next=11,this._loadTilesetFromUrl(a);case 11:return e.abrupt("return");case 12:return s=this.state,o=s.category,u=s.name,e.next=15,this._loadExampleTileset(o,u);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),a._loadExampleTileset=function(){var e=Vn(i.a.mark(function e(t,n){var r,a,s,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.state.examplesByCategory,e.t0=t,e.next="additional"===e.t0?4:"vricon"===e.t0?4:6;break;case 4:return s=r[t].examples[n],e.abrupt("break",8);case 6:(o=r[t].examples[n])&&o.tileset&&(a=Mn+"/"+o.path+"/"+o.tileset,s={tilesetUrl:a});case 8:this.setState({tilesetExampleProps:s});case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),a._loadTilesetFromIonAsset=function(){var e=Vn(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({tilesetExampleProps:{ionAccessToken:t,ionAssetId:n},category:"custom",name:"ION Tileset"});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),a._loadTilesetFromUrl=function(){var e=Vn(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({tilesetExampleProps:{tilesetUrl:t},category:"custom",name:"Custom Tileset"});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._updateStatWidgets=function(){this._tilesetStatsWidget&&this._tilesetStatsWidget.update(),this._memWidget&&this._memWidget.update()},a._onSelectExample=function(){var e=Vn(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.category,r=t.name,this.setState({category:n,name:r}),e.next=4,this._loadExampleTileset(n,r);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._onSelectMapStyle=function(e){var t=e.selectedMapStyle;this.setState({selectedMapStyle:t})},a._onTilesetLoad=function(e){this._tilesetStatsWidget.setStats(e.stats),this._tilesetStatsWidget.update();var t=e.cartographicCenter,n=e.zoom;this.setState({viewState:Object.assign({},this.state.viewState,{longitude:t[0],latitude:t[1],zoom:n,transitionDuration:3e3,transitionInterpolator:new l.a})})},a._onTilesetChange=function(e){this._updateStatWidgets(),this.forceUpdate()},a._onViewStateChange=function(e){var t=e.viewState;this.setState({viewState:t})},a._renderControlPanel=function(){var e=this.state,t=e.examplesByCategory,n=e.category,r=e.name,i=e.viewState,a=e.selectedMapStyle;return t?s.a.createElement(kn,{mapStyles:Hn,selectedMapStyle:a,data:t,category:n,name:r,onMapStyleChange:this._onSelectMapStyle.bind(this),onExampleChange:this._onSelectExample.bind(this)},s.a.createElement("div",null,"long/lat: ",i.longitude.toFixed(5),",",i.latitude.toFixed(5),", zoom:"," ",i.zoom.toFixed(2))):null},a._renderStats=function(){var e=this;return s.a.createElement("div",{style:{position:"absolute",padding:12,zIndex:"10000",maxWidth:300,background:"#000",color:"#fff"},ref:function(t){return e._statsWidgetContainer=t}})},a._renderTile3DLayer=function(){var e=this.state.tilesetExampleProps;if(!e)return null;var t=e.tilesetUrl,n=e.ionAssetId,r=e.ionAccessToken,i=e.coordinateOrigin;return new En({id:"tile-3d-layer",tilesetUrl:t,ionAssetId:n,ionAccessToken:r,coordinateOrigin:i,onTilesetLoad:this._onTilesetLoad,onTileLoad:this._onTilesetChange,onTileUnload:this._onTilesetChange,onTileLoadFail:this._onTilesetChange})},a.render=function(){var e=this,t=this.state,n=t.viewState,r=t.selectedMapStyle,i=this._renderTile3DLayer();return s.a.createElement("div",null,this._renderStats(),this._renderControlPanel(),s.a.createElement(c.a,{ref:function(t){return e._deckRef=t},layers:[i],initialViewState:Wn,viewState:n,onViewStateChange:this._onViewStateChange.bind(this),controller:{type:h.a,maxPitch:85},onAfterRender:function(){return e._updateStatWidgets()}},s.a.createElement(u.a,{mapStyle:r,mapboxApiAccessToken:"pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",preventStyleDiffing:!0})))},r}(a.PureComponent);function Qn(e){Object(o.render)(s.a.createElement(Yn,null),e)}},365:function(e,t,n){"use strict";n.d(t,"a",function(){return s});n(135),n(136),n(39),n(4);var r=n(296),i=n.n(r);n(297);function a(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function s(e){return o.apply(this,arguments)}function o(){var e;return e=i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="Failed to fetch resource "+t.url+" ("+t.status+"): ",e.prev=1,!t.headers.get("Content-Type").includes("application/json")){e.next=10;break}return e.t0=n,e.next=7,t.text();case 7:n=e.t0+=e.sent,e.next=11;break;case 10:n+=t.statusText;case 11:e.next=16;break;case 13:return e.prev=13,e.t1=e.catch(1),e.abrupt("return",n);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}},e,null,[[1,13]])}),(o=function(){var t=this,n=arguments;return new Promise(function(r,i){var s=e.apply(t,n);function o(e){a(s,r,i,o,u,"next",e)}function u(e){a(s,r,i,o,u,"throw",e)}o(void 0)})}).apply(this,arguments)}},490:function(e,t){},591:function(e,t,n){"use strict";(function(e,r){n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s});var i="object"!=typeof e||"[object process]"!==String(e)||e.browser,a={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==r&&r},s=a.global||a.self||a.window}).call(this,n(309),n(132))},592:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return E}),n.d(t,"a",function(){return I});n(295),n(24);function r(e,t,n){return t<=e&&e<=n}e["encoding-indexes"]={};var i=Math.floor;function a(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}function s(e){return 0<=e&&e<=127}var o=s,u=-1;function c(e){this.tokens=[].slice.call(e),this.tokens.reverse()}c.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.pop():u},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.pop());else this.tokens.push(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.shift());else this.tokens.unshift(e)}};var l=-1;function h(e,t){if(e)throw TypeError("Decoder error");return t||65533}function f(e){throw TypeError("The code point "+e+" could not be encoded.")}function d(e){return e=String(e).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(y,e)?y[e]:null}var p=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"UTF-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"IBM866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso88592","iso_8859-2","iso_8859-2:1987","l2","latin2"],name:"ISO-8859-2"},{labels:["csisolatin3","iso-8859-3","iso-ir-109","iso8859-3","iso88593","iso_8859-3","iso_8859-3:1988","l3","latin3"],name:"ISO-8859-3"},{labels:["csisolatin4","iso-8859-4","iso-ir-110","iso8859-4","iso88594","iso_8859-4","iso_8859-4:1988","l4","latin4"],name:"ISO-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso-ir-144","iso8859-5","iso88595","iso_8859-5","iso_8859-5:1988"],name:"ISO-8859-5"},{labels:["arabic","asmo-708","csiso88596e","csiso88596i","csisolatinarabic","ecma-114","iso-8859-6","iso-8859-6-e","iso-8859-6-i","iso-ir-127","iso8859-6","iso88596","iso_8859-6","iso_8859-6:1987"],name:"ISO-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso-ir-126","iso8859-7","iso88597","iso_8859-7","iso_8859-7:1987","sun_eu_greek"],name:"ISO-8859-7"},{labels:["csiso88598e","csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-e","iso-ir-138","iso8859-8","iso88598","iso_8859-8","iso_8859-8:1988","visual"],name:"ISO-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"ISO-8859-8-I"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","iso885910","l6","latin6"],name:"ISO-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"ISO-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"ISO-8859-14"},{labels:["csisolatin9","iso-8859-15","iso8859-15","iso885915","iso_8859-15","l9"],name:"ISO-8859-15"},{labels:["iso-8859-16"],name:"ISO-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"KOI8-R"},{labels:["koi8-ru","koi8-u"],name:"KOI8-U"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["dos-874","iso-8859-11","iso8859-11","iso885911","tis-620","windows-874"],name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ansi_x3.4-1968","ascii","cp1252","cp819","csisolatin1","ibm819","iso-8859-1","iso-ir-100","iso8859-1","iso88591","iso_8859-1","iso_8859-1:1987","l1","latin1","us-ascii","windows-1252","x-cp1252"],name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:["cp1254","csisolatin5","iso-8859-9","iso-ir-148","iso8859-9","iso88599","iso_8859-9","iso_8859-9:1989","l5","latin5","windows-1254","x-cp1254"],name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb2312","gb_2312","gb_2312-80","gbk","iso-ir-58","x-gbk"],name:"GBK"},{labels:["gb18030"],name:"gb18030"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"Big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"EUC-JP"},{labels:["csiso2022jp","iso-2022-jp"],name:"ISO-2022-JP"},{labels:["csshiftjis","ms932","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"Shift_JIS"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"EUC-KR"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","hz-gb-2312","iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"UTF-16BE"},{labels:["utf-16","utf-16le"],name:"UTF-16LE"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],y={};p.forEach(function(e){e.encodings.forEach(function(e){e.labels.forEach(function(t){y[t]=e})})});var m,v,_={},g={};function b(e,t){return t&&t[e]||null}function T(e,t){var n=t.indexOf(e);return-1===n?null:n}function w(t){if(!("encoding-indexes"in e))throw Error("Indexes missing. Did you forget to include encoding-indexes.js first?");return e["encoding-indexes"][t]}var x="utf-8";function I(e,t){if(!(this instanceof I))throw TypeError("Called as a function. Did you forget 'new'?");e=void 0!==e?String(e):x,t=a(t),this._encoding=null,this._decoder=null,this._ignoreBOM=!1,this._BOMseen=!1,this._error_mode="replacement",this._do_not_flush=!1;var n=d(e);if(null===n||"replacement"===n.name)throw RangeError("Unknown encoding: "+e);if(!g[n.name])throw Error("Decoder not present. Did you forget to include encoding-indexes.js first?");return this._encoding=n,Boolean(t.fatal)&&(this._error_mode="fatal"),Boolean(t.ignoreBOM)&&(this._ignoreBOM=!0),Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase(),this.fatal="fatal"===this._error_mode,this.ignoreBOM=this._ignoreBOM),this}function E(t,n){if(!(this instanceof E))throw TypeError("Called as a function. Did you forget 'new'?");n=a(n),this._encoding=null,this._encoder=null,this._do_not_flush=!1,this._fatal=Boolean(n.fatal)?"fatal":"replacement";if(Boolean(n.NONSTANDARD_allowLegacyEncoding)){var r=d(t=void 0!==t?String(t):x);if(null===r||"replacement"===r.name)throw RangeError("Unknown encoding: "+t);if(!_[r.name])throw Error("Encoder not present. Did you forget to include encoding-indexes.js first?");this._encoding=r}else this._encoding=d("utf-8"),void 0!==t&&"console"in e&&console.warn("TextEncoder constructor called with encoding label, which is ignored.");return Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase()),this}function S(e){var t=e.fatal,n=0,i=0,a=0,s=128,o=191;this.handler=function(e,c){if(c===u&&0!==a)return a=0,h(t);if(c===u)return l;if(0===a){if(r(c,0,127))return c;if(r(c,194,223))a=1,n=31&c;else if(r(c,224,239))224===c&&(s=160),237===c&&(o=159),a=2,n=15&c;else{if(!r(c,240,244))return h(t);240===c&&(s=144),244===c&&(o=143),a=3,n=7&c}return null}if(!r(c,s,o))return n=a=i=0,s=128,o=191,e.prepend(c),h(t);if(s=128,o=191,n=n<<6|63&c,(i+=1)!==a)return null;var f=n;return n=a=i=0,f}}function O(e){e.fatal;this.handler=function(e,t){if(t===u)return l;if(o(t))return t;var n,i;r(t,128,2047)?(n=1,i=192):r(t,2048,65535)?(n=2,i=224):r(t,65536,1114111)&&(n=3,i=240);for(var a=[(t>>6*n)+i];n>0;){var s=t>>6*(n-1);a.push(128|63&s),n-=1}return a}}function A(e,t){var n=t.fatal;this.handler=function(t,r){if(r===u)return l;if(s(r))return r;var i=e[r-128];return null===i?h(n):i}}function k(e,t){t.fatal;this.handler=function(t,n){if(n===u)return l;if(o(n))return n;var r=T(n,e);return null===r&&f(n),r+128}}function N(e){var t=e.fatal,n=0,i=0,a=0;this.handler=function(e,o){if(o===u&&0===n&&0===i&&0===a)return l;var c;if(o!==u||0===n&&0===i&&0===a||(n=0,i=0,a=0,h(t)),0!==a){c=null,r(o,48,57)&&(c=function(e){if(e>39419&&e<189e3||e>1237575)return null;if(7457===e)return 59335;var t,n=0,r=0,i=w("gb18030-ranges");for(t=0;t<i.length;++t){var a=i[t];if(!(a[0]<=e))break;n=a[0],r=a[1]}return r+e-n}(10*(126*(10*(n-129)+i-48)+a-129)+o-48));var f=[i,a,o];return n=0,i=0,a=0,null===c?(e.prepend(f),h(t)):c}if(0!==i)return r(o,129,254)?(a=o,null):(e.prepend([i,o]),n=0,i=0,h(t));if(0!==n){if(r(o,48,57))return i=o,null;var d=n,p=null;n=0;var y=o<127?64:65;return(r(o,64,126)||r(o,128,254))&&(p=190*(d-129)+(o-y)),null===(c=null===p?null:b(p,w("gb18030")))&&s(o)&&e.prepend(o),null===c?h(t):c}return s(o)?o:128===o?8364:r(o,129,254)?(n=o,null):h(t)}}function C(e,t){e.fatal;this.handler=function(e,n){if(n===u)return l;if(o(n))return n;if(58853===n)return f(n);if(t&&8364===n)return 128;var r=T(n,w("gb18030"));if(null!==r){var a=r%190;return[i(r/190)+129,a+(a<63?64:65)]}if(t)return f(n);r=function(e){if(59335===e)return 7457;var t,n=0,r=0,i=w("gb18030-ranges");for(t=0;t<i.length;++t){var a=i[t];if(!(a[1]<=e))break;n=a[1],r=a[0]}return r+e-n}(n);var s=i(r/10/126/10),c=i((r-=10*s*126*10)/10/126),h=i((r-=10*c*126)/10);return[s+129,c+48,h+129,r-10*h+48]}}function L(e){var t=e.fatal,n=0;this.handler=function(e,i){if(i===u&&0!==n)return n=0,h(t);if(i===u&&0===n)return l;if(0!==n){var a=n,o=null;n=0;var c=i<127?64:98;switch((r(i,64,126)||r(i,161,254))&&(o=157*(a-129)+(i-c)),o){case 1133:return[202,772];case 1135:return[202,780];case 1164:return[234,772];case 1166:return[234,780]}var f=null===o?null:b(o,w("big5"));return null===f&&s(i)&&e.prepend(i),null===f?h(t):f}return s(i)?i:r(i,129,254)?(n=i,null):h(t)}}function P(e){e.fatal;this.handler=function(e,t){if(t===u)return l;if(o(t))return t;var n=function(e){var t=v=v||w("big5").map(function(e,t){return t<5024?null:e});return 9552===e||9566===e||9569===e||9578===e||21313===e||21317===e?t.lastIndexOf(e):T(e,t)}(t);if(null===n)return f(t);var r=i(n/157)+129;if(r<161)return f(t);var a=n%157;return[r,a+(a<63?64:98)]}}function D(e){var t=e.fatal,n=!1,i=0;this.handler=function(e,a){if(a===u&&0!==i)return i=0,h(t);if(a===u&&0===i)return l;if(142===i&&r(a,161,223))return i=0,65216+a;if(143===i&&r(a,161,254))return n=!0,i=a,null;if(0!==i){var o=i;i=0;var c=null;return r(o,161,254)&&r(a,161,254)&&(c=b(94*(o-161)+(a-161),w(n?"jis0212":"jis0208"))),n=!1,r(a,161,254)||e.prepend(a),null===c?h(t):c}return s(a)?a:142===a||143===a||r(a,161,254)?(i=a,null):h(t)}}function M(e){e.fatal;this.handler=function(e,t){if(t===u)return l;if(o(t))return t;if(165===t)return 92;if(8254===t)return 126;if(r(t,65377,65439))return[142,t-65377+161];8722===t&&(t=65293);var n=T(t,w("jis0208"));return null===n?f(t):[i(n/94)+161,n%94+161]}}function U(e){var t=e.fatal,n=0,i=1,a=2,s=3,o=4,c=5,f=6,d=n,p=n,y=0,m=!1;this.handler=function(e,v){switch(d){default:case n:return 27===v?(d=c,null):r(v,0,127)&&14!==v&&15!==v&&27!==v?(m=!1,v):v===u?l:(m=!1,h(t));case i:return 27===v?(d=c,null):92===v?(m=!1,165):126===v?(m=!1,8254):r(v,0,127)&&14!==v&&15!==v&&27!==v&&92!==v&&126!==v?(m=!1,v):v===u?l:(m=!1,h(t));case a:return 27===v?(d=c,null):r(v,33,95)?(m=!1,65344+v):v===u?l:(m=!1,h(t));case s:return 27===v?(d=c,null):r(v,33,126)?(m=!1,y=v,d=o,null):v===u?l:(m=!1,h(t));case o:if(27===v)return d=c,h(t);if(r(v,33,126)){d=s;var _=b(94*(y-33)+v-33,w("jis0208"));return null===_?h(t):_}return v===u?(d=s,e.prepend(v),h(t)):(d=s,h(t));case c:return 36===v||40===v?(y=v,d=f,null):(e.prepend(v),m=!1,d=p,h(t));case f:var g=y;y=0;var T=null;if(40===g&&66===v&&(T=n),40===g&&74===v&&(T=i),40===g&&73===v&&(T=a),36!==g||64!==v&&66!==v||(T=s),null!==T){d=d=T;var x=m;return m=!0,x?h(t):null}return e.prepend([g,v]),m=!1,d=p,h(t)}}}function R(e){e.fatal;var t=0,n=1,r=2,a=t;this.handler=function(e,s){if(s===u&&a!==t)return e.prepend(s),a=t,[27,40,66];if(s===u&&a===t)return l;if(!(a!==t&&a!==n||14!==s&&15!==s&&27!==s))return f(65533);if(a===t&&o(s))return s;if(a===n&&(o(s)&&92!==s&&126!==s||165==s||8254==s)){if(o(s))return s;if(165===s)return 92;if(8254===s)return 126}if(o(s)&&a!==t)return e.prepend(s),a=t,[27,40,66];if((165===s||8254===s)&&a!==n)return e.prepend(s),a=n,[27,40,74];8722===s&&(s=65293);var c=T(s,w("jis0208"));return null===c?f(s):a!==r?(e.prepend(s),a=r,[27,36,66]):[i(c/94)+33,c%94+33]}}function B(e){var t=e.fatal,n=0;this.handler=function(e,i){if(i===u&&0!==n)return n=0,h(t);if(i===u&&0===n)return l;if(0!==n){var a=n,o=null;n=0;var c=i<127?64:65,f=a<160?129:193;if((r(i,64,126)||r(i,128,252))&&(o=188*(a-f)+i-c),r(o,8836,10715))return 48508+o;var d=null===o?null:b(o,w("jis0208"));return null===d&&s(i)&&e.prepend(i),null===d?h(t):d}return s(i)||128===i?i:r(i,161,223)?65216+i:r(i,129,159)||r(i,224,252)?(n=i,null):h(t)}}function F(e){e.fatal;this.handler=function(e,t){if(t===u)return l;if(o(t)||128===t)return t;if(165===t)return 92;if(8254===t)return 126;if(r(t,65377,65439))return t-65377+161;8722===t&&(t=65293);var n=function(e){return(m=m||w("jis0208").map(function(e,t){return r(t,8272,8835)?null:e})).indexOf(e)}(t);if(null===n)return f(t);var a=i(n/188),s=n%188;return[a+(a<31?129:193),s+(s<63?64:65)]}}function j(e){var t=e.fatal,n=0;this.handler=function(e,i){if(i===u&&0!==n)return n=0,h(t);if(i===u&&0===n)return l;if(0!==n){var a=n,o=null;n=0,r(i,65,254)&&(o=190*(a-129)+(i-65));var c=null===o?null:b(o,w("euc-kr"));return null===o&&s(i)&&e.prepend(i),null===c?h(t):c}return s(i)?i:r(i,129,254)?(n=i,null):h(t)}}function V(e){e.fatal;this.handler=function(e,t){if(t===u)return l;if(o(t))return t;var n=T(t,w("euc-kr"));return null===n?f(t):[i(n/190)+129,n%190+65]}}function G(e,t){var n=e>>8,r=255&e;return t?[n,r]:[r,n]}function q(e,t){var n=t.fatal,i=null,a=null;this.handler=function(t,s){if(s===u&&(null!==i||null!==a))return h(n);if(s===u&&null===i&&null===a)return l;if(null===i)return i=s,null;var o;if(o=e?(i<<8)+s:(s<<8)+i,i=null,null!==a){var c=a;return a=null,r(o,56320,57343)?65536+1024*(c-55296)+(o-56320):(t.prepend(G(o,e)),h(n))}return r(o,55296,56319)?(a=o,null):r(o,56320,57343)?h(n):o}}function z(e,t){t.fatal;this.handler=function(t,n){if(n===u)return l;if(r(n,0,65535))return G(n,e);var i=G(55296+(n-65536>>10),e),a=G(56320+(n-65536&1023),e);return i.concat(a)}}function H(e){e.fatal;this.handler=function(e,t){return t===u?l:s(t)?t:63360+t-128}}function J(e){e.fatal;this.handler=function(e,t){return t===u?l:o(t)?t:r(t,63360,63487)?t-63360+128:f(t)}}Object.defineProperty&&(Object.defineProperty(I.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),Object.defineProperty(I.prototype,"fatal",{get:function(){return"fatal"===this._error_mode}}),Object.defineProperty(I.prototype,"ignoreBOM",{get:function(){return this._ignoreBOM}})),I.prototype.decode=function(e,t){var n;n="object"==typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"==typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t=a(t),this._do_not_flush||(this._decoder=g[this._encoding.name]({fatal:"fatal"===this._error_mode}),this._BOMseen=!1),this._do_not_flush=Boolean(t.stream);for(var r,i=new c(n),s=[];;){var o=i.read();if(o===u)break;if((r=this._decoder.handler(i,o))===l)break;null!==r&&(Array.isArray(r)?s.push.apply(s,r):s.push(r))}if(!this._do_not_flush){do{if((r=this._decoder.handler(i,i.read()))===l)break;null!==r&&(Array.isArray(r)?s.push.apply(s,r):s.push(r))}while(!i.endOfStream());this._decoder=null}return function(e){var t,n;return t=["UTF-8","UTF-16LE","UTF-16BE"],n=this._encoding.name,-1===t.indexOf(n)||this._ignoreBOM||this._BOMseen||(e.length>0&&65279===e[0]?(this._BOMseen=!0,e.shift()):e.length>0&&(this._BOMseen=!0)),function(e){for(var t="",n=0;n<e.length;++n){var r=e[n];r<=65535?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode(55296+(r>>10),56320+(1023&r)))}return t}(e)}.call(this,s)},Object.defineProperty&&Object.defineProperty(E.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),E.prototype.encode=function(e,t){e=void 0===e?"":String(e),t=a(t),this._do_not_flush||(this._encoder=_[this._encoding.name]({fatal:"fatal"===this._fatal})),this._do_not_flush=Boolean(t.stream);for(var n,r=new c(function(e){for(var t=String(e),n=t.length,r=0,i=[];r<n;){var a=t.charCodeAt(r);if(a<55296||a>57343)i.push(a);else if(56320<=a&&a<=57343)i.push(65533);else if(55296<=a&&a<=56319)if(r===n-1)i.push(65533);else{var s=t.charCodeAt(r+1);if(56320<=s&&s<=57343){var o=1023&a,u=1023&s;i.push(65536+(o<<10)+u),r+=1}else i.push(65533)}r+=1}return i}(e)),i=[];;){var s=r.read();if(s===u)break;if((n=this._encoder.handler(r,s))===l)break;Array.isArray(n)?i.push.apply(i,n):i.push(n)}if(!this._do_not_flush){for(;(n=this._encoder.handler(r,r.read()))!==l;)Array.isArray(n)?i.push.apply(i,n):i.push(n);this._encoder=null}return new Uint8Array(i)},_["UTF-8"]=function(e){return new O(e)},g["UTF-8"]=function(e){return new S(e)},"encoding-indexes"in e&&p.forEach(function(e){"Legacy single-byte encodings"===e.heading&&e.encodings.forEach(function(e){var t=e.name,n=w(t.toLowerCase());g[t]=function(e){return new A(n,e)},_[t]=function(e){return new k(n,e)}})}),g.GBK=function(e){return new N(e)},_.GBK=function(e){return new C(e,!0)},_.gb18030=function(e){return new C(e)},g.gb18030=function(e){return new N(e)},_.Big5=function(e){return new P(e)},g.Big5=function(e){return new L(e)},_["EUC-JP"]=function(e){return new M(e)},g["EUC-JP"]=function(e){return new D(e)},_["ISO-2022-JP"]=function(e){return new R(e)},g["ISO-2022-JP"]=function(e){return new U(e)},_.Shift_JIS=function(e){return new F(e)},g.Shift_JIS=function(e){return new B(e)},_["EUC-KR"]=function(e){return new V(e)},g["EUC-KR"]=function(e){return new j(e)},_["UTF-16BE"]=function(e){return new z(!0,e)},g["UTF-16BE"]=function(e){return new q(!0,e)},_["UTF-16LE"]=function(e){return new z(!1,e)},g["UTF-16LE"]=function(e){return new q(!1,e)},_["x-user-defined"]=function(e){return new J(e)},g["x-user-defined"]=function(e){return new H(e)}}).call(this,n(132))},593:function(e,t){},594:function(e,t){},595:function(e,t){},596:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return w}),n.d(t,"a",function(){return I});n(3),n(133),n(39),n(4);var r=n(296),i=n.n(r),a=(n(297),n(490)),s=n.n(a),o=n(597),u=n.n(o),c=n(598),l=n.n(c),h=n(599),f=n.n(h),d=n(600),p=n(601),y=n.n(p),m=n(602);function v(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function _(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function s(e){v(a,r,i,s,o,"next",e)}function o(e){v(a,r,i,s,o,"throw",e)}s(void 0)})}}var g={dataType:"arraybuffer"},b=function(e){return e.startsWith("data:")},T=function(e){return e.startsWith("http:")||e.startsWith("https:")};function w(e,t){return x.apply(this,arguments)}function x(){return(x=_(i.a.mark(function t(n,r){var a,o,c;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r={}),r=S(r),!b(n)){t.next=4;break}return t.abrupt("return",Promise.resolve(y()(n)));case 4:if(!T(n)){t.next=6;break}return t.abrupt("return",new Promise(function(e,t){r=Object.assign({},new URL(n),{},r),(n.startsWith("https:")?l.a.request:u.a.request)(n,function(n){return Object(m.concatenateReadStream)(n).then(e,t)})}));case 6:return a=n&&n.lastIndexOf("?"),n=a>=0?n.substr(0,a):n,o=f.a.promisify(s.a.readFile),t.next=11,o(n,r);case 11:return c=t.sent,t.abrupt("return",c instanceof e?Object(d.toArrayBuffer)(c):c);case 13:case"end":return t.stop()}},t)}))).apply(this,arguments)}function I(e,t){return E.apply(this,arguments)}function E(){return(E=_(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!b(t)){e.next=2;break}return e.abrupt("return",y()(t));case 2:if(T(t)){e.next=4;break}return e.abrupt("return",s.a.createReadStream(t,n));case 4:return e.abrupt("return",new Promise(function(e,r){n=Object.assign({},new URL(t),{},n),(t.startsWith("https:")?l.a.request:u.a.request)(t,function(t){return e(t)})}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){return void 0===e&&(e={}),(e=Object.assign({},g,e)).responseType=e.responseType||e.dataType,s.a&&(e.encoding=e.encoding||("text"===e.dataType?"utf8":null)),e}}).call(this,n(419).Buffer)},597:function(e,t){},598:function(e,t){},599:function(e,t){},600:function(e,t){},601:function(e,t){},602:function(e,t){},603:function(e,t){},604:function(e,t){},605:function(e,t){},613:function(e,t,n){"use strict";(function(e,r){n.d(t,"a",function(){return a});"object"!=typeof e||"[object process]"!==String(e)||e.browser;var i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==r&&r},a=i.global||i.self||i.window}).call(this,n(309),n(132))},667:function(e,t,n){"use strict";n(295),n(39),n(4);var r=n(296),i=n.n(r),a=(n(297),n(613));n(507);function s(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,u,"next",e)}function u(e){s(a,r,i,o,u,"throw",e)}o(void 0)})}}a.a._parseImageNode;function u(e,t){return c.apply(this,arguments)}function c(){return(c=o(i.a.mark(function e(t,n){var r,a,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!/\.svg((\?|#).*)?$/.test(t)){e.next=10;break}return e.next=3,fetch(t,n);case 3:return a=e.sent,e.next=6,a.text();case 6:s=e.sent,r="data:image/svg+xml;base64,"+btoa(s),e.next=13;break;case 10:return e.next=12,t;case 12:r=e.sent;case 13:return e.next=15,new Promise(function(e,i){try{var a=new Image;a.onload=function(){return e(a)},a.onerror=function(e){return i(new Error("Could not load image "+t+": "+e))},a.crossOrigin=n&&n.crossOrigin||"anonymous",a.src=r}catch(s){i(s)}});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}n.d(t,"a",function(){return h});var l=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],h={extensions:l,loadAndParse:u}}}]);